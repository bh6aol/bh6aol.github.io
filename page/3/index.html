<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>BH6AOL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="BH6AOL">
<meta property="og:url" content="https://bh6aol.top/page/3/index.html">
<meta property="og:site_name" content="BH6AOL">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="BH6AOL">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="BH6AOL" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">BH6AOL</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">CQ CQ CQ, this is BH6AOL, calling CQ and standing by.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://bh6aol.top"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-pip使用技巧总结" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/10/14/pip%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E6%80%BB%E7%BB%93/" class="article-date">
  <time class="dt-published" datetime="2019-10-14T14:30:41.000Z" itemprop="datePublished">2019-10-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/10/14/pip%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E6%80%BB%E7%BB%93/">pip使用技巧总结</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>每次使用pip安装包的时候总是忘记加-i参数来指定仓库，导致下载时速度非常慢，反手ctrl c再添加**-i <a target="_blank" rel="noopener" href="https://pypi.mirrors.ustc.edu.cn/simple">https://pypi.mirrors.ustc.edu.cn/simple</a>** 。经常输这个镜像地址，现在国内几大镜像地址都会背了！！！</p>
<p>那么怎么操作才能把默认仓库改成国内的呢？百度一下，具体方法如下：</p>
<h3 id="1-在～里面创建一个配置文件"><a href="#1-在～里面创建一个配置文件" class="headerlink" title="1.在～里面创建一个配置文件"></a>1.在～里面创建一个配置文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir ~&#x2F;.pip</span><br></pre></td></tr></table></figure>

<h3 id="2-编辑pip-conf文件"><a href="#2-编辑pip-conf文件" class="headerlink" title="2.编辑pip.conf文件"></a>2.编辑pip.conf文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano ~&#x2F;.pip&#x2F;pip.conf</span><br></pre></td></tr></table></figure>

<p>添加如下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">timeout &#x3D; 6000</span><br><span class="line">index-url &#x3D; http:&#x2F;&#x2F;pypi.mirrors.ustc.edu.cn&#x2F;simple&#x2F;</span><br><span class="line">trusted-host &#x3D; pypi.mirrors.ustc.edu.cn</span><br></pre></td></tr></table></figure>

<p>这下就换成了USTC的仓库了，试一下？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@SENCOM:~# pip3 install django</span><br><span class="line">Looking in indexes: http:&#x2F;&#x2F;pypi.mirrors.ustc.edu.cn&#x2F;simple&#x2F;</span><br><span class="line">Collecting django</span><br><span class="line">  Downloading https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;pypi&#x2F;web&#x2F;packages&#x2F;b2&#x2F;79&#x2F;df0ffea7bf1e02c073c2633702c90f4384645c40a1dd09a308e02ef0c817&#x2F;Django-2.2.6-py3-none-any.whl (7.5MB)</span><br><span class="line">     |████████████████████████████████| 7.5MB 2.0MB&#x2F;s </span><br><span class="line">Collecting pytz (from django)</span><br><span class="line">  Downloading https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;pypi&#x2F;web&#x2F;packages&#x2F;87&#x2F;76&#x2F;46d697698a143e05f77bec5a526bf4e56a0be61d63425b68f4ba553b51f2&#x2F;pytz-2019.2-py2.py3-none-any.whl (508kB)</span><br><span class="line">     |████████████████████████████████| 512kB 12.9MB&#x2F;s </span><br><span class="line">Collecting sqlparse (from django)</span><br><span class="line">  Downloading https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;pypi&#x2F;web&#x2F;packages&#x2F;ef&#x2F;53&#x2F;900f7d2a54557c6a37886585a91336520e5539e3ae2423ff1102daf4f3a7&#x2F;sqlparse-0.3.0-py2.py3-none-any.whl</span><br><span class="line">Installing collected packages: pytz, sqlparse, django</span><br><span class="line">Successfully installed django-2.2.6 pytz-2019.2 sqlparse-0.3.0</span><br></pre></td></tr></table></figure>

<p>唉，USTC咋跳转到tsinghua了呢？不管了，能用就OK，百兆小水管终于可以满载啦！</p>
<hr>
<p>1，使用pip安装新的库<br> pip install 库名</p>
<p>2，列出已经安装的库<br> pip list</p>
<p>3，列出过期的库<br> pip list –outdated</p>
<p>4，升级库<br> pip install –upgrade 库名</p>
<p>5，显示包的详细信息<br> pip show 库名</p>
<p>6，安装指定版本号的包<br> pip install -v 库名==版本</p>
<p>7，卸载<br> pip uninstall 库名</p>
<p>8 ，查找包<br> pip search package</p>
<hr>
<p>2019/11/1补充</p>
<h2 id="1-大胆尝试"><a href="#1-大胆尝试" class="headerlink" title="1.大胆尝试"></a>1.大胆尝试</h2><p>模仿Linux上的成功方法进行如下设置：</p>
<p>在我的用户目录下创建文件**~.pip3\pip.conf**</p>
<p>好了？？？试一下便知！正好由于上次hyper-v事件导致软件丢失，就拿wxpython这个包来测试一下安装把！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Michael Jiang&gt;pip install wxpython</span><br><span class="line">Collecting wxpython</span><br><span class="line">  Downloading https:&#x2F;&#x2F;files.pythonhosted.org&#x2F;packages&#x2F;b1&#x2F;aa&#x2F;a5c3953c3e888c0d9c5115fa28c3fcba8aea07614542cf846004f4dca4d9&#x2F;wxPython-4.0.7.post1-cp37-cp37m-win32.whl (14.0MB)</span><br><span class="line">     |                                | 51kB 19kB&#x2F;s eta 0:11:45</span><br><span class="line">ERROR: Operation cancelled by user</span><br></pre></td></tr></table></figure>

<p>好像没有起作用哎！</p>
<h2 id="2-Bing找解决方法"><a href="#2-Bing找解决方法" class="headerlink" title="2.Bing找解决方法"></a>2.Bing找解决方法</h2><p>还是Hyper-v事件我现在还不能访问Google，所以只能Bing了</p>
<p>最终在这里找到了解决方法：<a target="_blank" rel="noopener" href="https://github.com/pypa/pip/issues/4087">https://github.com/pypa/pip/issues/4087</a></p>
<p>总结一下就是如下操作：</p>
<ul>
<li><p>首先检查一下你的AppData目录位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Michael Jiang&gt;echo %APPDATA%</span><br><span class="line">C:\Users\Michael Jiang\AppData\Roaming</span><br></pre></td></tr></table></figure>

<p>可以看出我的是在<strong>C:\Users\Michael Jiang\AppData\Roaming</strong></p>
</li>
<li><p>接下来就是在这个目录里创建pip文件夹并在pip文件夹里创建文件<strong>pip.ini</strong></p>
</li>
<li><p>pip.ini 里面保存如下内容</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">timeout = 6000</span><br><span class="line">index-url = http://pypi.mirrors.ustc.edu.cn/simple/</span><br><span class="line">trusted-host = pypi.mirrors.ustc.edu.cn</span><br></pre></td></tr></table></figure>

<p>OK，搞定</p>
</li>
</ul>
<p>最后看一下配置是否生效了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Michael Jiang&gt;pip install wxpython</span><br><span class="line">Looking in indexes: http:&#x2F;&#x2F;pypi.mirrors.ustc.edu.cn&#x2F;simple&#x2F;</span><br><span class="line">Collecting wxpython</span><br><span class="line">  Downloading https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;pypi&#x2F;web&#x2F;packages&#x2F;b1&#x2F;aa&#x2F;a5c3953c3e888c0d9c5115fa28c3fcba8aea07614542cf846004f4dca4d9&#x2F;wxPython-4.0.7.post1-cp37-cp37m-win32.whl (14.0MB)</span><br><span class="line">     |████████████████████████████████| 14.0MB 363kB&#x2F;s</span><br><span class="line">Collecting six</span><br><span class="line">  Using cached https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;pypi&#x2F;web&#x2F;packages&#x2F;73&#x2F;fb&#x2F;00a976f728d0d1fecfe898238ce23f502a721c0ac0ecfedb80e0d88c64e9&#x2F;six-1.12.0-py2.py3-none-any.whl</span><br><span class="line">Requirement already satisfied: numpy; python_version &gt;&#x3D; &quot;3.0&quot; in d:\devsoftware\python3.7.4\lib\site-packages (from wxpython) (1.17.3)</span><br><span class="line">Collecting pillow</span><br><span class="line">  Using cached https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;pypi&#x2F;web&#x2F;packages&#x2F;4b&#x2F;88&#x2F;0a35f7ae1e436309a97c92fec81c1ab7d70b4a0646f39b420cbcecfb2de6&#x2F;Pillow-6.2.1-cp37-cp37m-win32.whl</span><br><span class="line">Installing collected packages: six, pillow, wxpython</span><br><span class="line">Successfully installed pillow-6.2.1 six-1.12.0 wxpython-4.0.7.post1</span><br></pre></td></tr></table></figure>

<p>的确成功了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/10/14/pip%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E6%80%BB%E7%BB%93/" data-id="cknhjzf8y0000igtvg0zg6jmn" data-title="pip使用技巧总结" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pip/" rel="tag">pip</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pyhthon/" rel="tag">pyhthon</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-操作系统之页面置换算法-OPT，FIFO，LRU，CLOCK" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/10/06/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B%E9%A1%B5%E9%9D%A2%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95-OPT%EF%BC%8CFIFO%EF%BC%8CLRU%EF%BC%8CCLOCK/" class="article-date">
  <time class="dt-published" datetime="2019-10-06T14:36:31.000Z" itemprop="datePublished">2019-10-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/10/06/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B%E9%A1%B5%E9%9D%A2%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95-OPT%EF%BC%8CFIFO%EF%BC%8CLRU%EF%BC%8CCLOCK/">操作系统之页面置换算法-OPT，FIFO，LRU，CLOCK</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="0、写在前面"><a href="#0、写在前面" class="headerlink" title="0、写在前面"></a>0、写在前面</h2><p>在进程运行过程中，若其所要访问的页面不在内存，而需要把他们调入内存，但内存已无空闲空间时，为了保证该进程能正常运行，系统必须从内存中调出一页程序或者数据送到磁盘对换区中。但应将那个页面调出，必须根据一定的算法来确定。我们通常把这类算法称为<strong>页面置换算法（Page-Repleacement Algorithms）。</strong>置换算法的好坏直接影响系统的性能。</p>
<p><img src="/images/2019-10-05_22-42-54.png" alt="img"></p>
<h2 id="1、最佳置换算法-OPT"><a href="#1、最佳置换算法-OPT" class="headerlink" title="1、最佳置换算法(OPT)"></a>1、最佳置换算法(OPT)</h2><p>最佳置换算法由Belady于1966年提出的一种理论上的算法。其所选择的被淘汰页面将是以后永不使用的，或许是在最长时间内不再被访问的页面。但由于无法预知一个进程在内存中的若干个页面中，哪个是未来最长时间内不再被访问的，因而该算法是无法实现的，但可以利用该算法去评价其他算法。</p>
<p>optiaml.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 页面置换算法之最佳置换算法</span></span><br><span class="line"><span class="comment"> * Michael Jiang</span></span><br><span class="line"><span class="comment"> * Fri 04 Oct 2019 10:54:02 PM CST</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">optimal</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 无法实现</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h2 id="2、先进先出置换算法-FIFO"><a href="#2、先进先出置换算法-FIFO" class="headerlink" title="2、先进先出置换算法(FIFO)"></a>2、先进先出置换算法(FIFO)</h2><p>FIFO算法是最早出现的置换算法。该算法总是淘汰最先进入内存的页面，即选择在内存中驻留时间最长的的页面予以淘汰。该算法实现简单(但是需要一个队列)</p>
<p>queue.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _QUEUE_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _QUEUE_H</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> data;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;Node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">LinkQueue</span>&#123;</span></span><br><span class="line">	Node *front;</span><br><span class="line">	Node *rear;</span><br><span class="line">	<span class="keyword">uint8_t</span> size;</span><br><span class="line">&#125;LinkQueue;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">queue_init</span><span class="params">(LinkQueue **<span class="built_in">queue</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">queue_push</span><span class="params">(LinkQueue **<span class="built_in">queue</span>,<span class="keyword">int</span> data)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">queue_pop</span><span class="params">(LinkQueue **<span class="built_in">queue</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">queue_front</span><span class="params">(LinkQueue **<span class="built_in">queue</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">uint8_t</span> <span class="title">queue_size</span><span class="params">(LinkQueue **<span class="built_in">queue</span>)</span></span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>queue.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;queue.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">queue_init</span><span class="params">(LinkQueue **<span class="built_in">queue</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	(*<span class="built_in">queue</span>)-&gt;front = (*<span class="built_in">queue</span>)-&gt;rear = <span class="literal">NULL</span>;</span><br><span class="line">	(*<span class="built_in">queue</span>)-&gt;size = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">queue_push</span><span class="params">(LinkQueue **<span class="built_in">queue</span>,<span class="keyword">int</span> data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Node *node = (Node *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Node));</span><br><span class="line">	node-&gt;data = data;</span><br><span class="line">	node-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>((*<span class="built_in">queue</span>)-&gt;front == <span class="literal">NULL</span>)&#123;</span><br><span class="line">		(*<span class="built_in">queue</span>)-&gt;front = node;</span><br><span class="line">		(*<span class="built_in">queue</span>)-&gt;rear = node;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		(*<span class="built_in">queue</span>)-&gt;rear-&gt;next = node;</span><br><span class="line">		(*<span class="built_in">queue</span>)-&gt;rear = node;</span><br><span class="line">	&#125;</span><br><span class="line">	(*<span class="built_in">queue</span>)-&gt;size++;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">uint8_t</span> <span class="title">queue_size</span><span class="params">(LinkQueue **<span class="built_in">queue</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (*<span class="built_in">queue</span>)-&gt;size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">queue_pop</span><span class="params">(LinkQueue **<span class="built_in">queue</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>((*<span class="built_in">queue</span>)-&gt;front == <span class="literal">NULL</span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	Node *p = (*<span class="built_in">queue</span>)-&gt;front;</span><br><span class="line">	(*<span class="built_in">queue</span>)-&gt;front = (*<span class="built_in">queue</span>)-&gt;front-&gt;next;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">free</span>(p);</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">queue_front</span><span class="params">(LinkQueue **<span class="built_in">queue</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (*<span class="built_in">queue</span>)-&gt;front-&gt;data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>FIFO.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 页面置换算法之先进先出页面置换算法</span></span><br><span class="line"><span class="comment"> * Michael Jiang</span></span><br><span class="line"><span class="comment"> * Fri 04 Oct 2019 10:54:02 PM CST</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;queue.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">current_in_block</span><span class="params">(<span class="keyword">int</span> *block, <span class="keyword">int</span> current)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(current == block[i])&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* FIFO 页面置换算法</span></span><br><span class="line"><span class="comment"> * @param page_index:进程使用的页面序列</span></span><br><span class="line"><span class="comment"> * @param block:进程分配到的物理块</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FIFO</span><span class="params">(<span class="keyword">int</span> *page_index, <span class="keyword">int</span> *block)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 撸个队列出来</span></span><br><span class="line">	LinkQueue *<span class="built_in">queue</span> = (LinkQueue *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(LinkQueue));</span><br><span class="line">	queue_init(&amp;<span class="built_in">queue</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 页面替换次数</span></span><br><span class="line">	<span class="keyword">uint8_t</span> r_times = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 先将三个物理块填满</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">		block[i] = page_index[i];</span><br><span class="line">		queue_push(&amp;<span class="built_in">queue</span>, page_index[i]);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">size_t</span> t = <span class="number">0</span>; t &lt; <span class="number">3</span>; t++)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,block[t]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 执行置换</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">3</span>; i &lt; <span class="number">20</span>; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">size_t</span> t = <span class="number">0</span>; t &lt; <span class="number">3</span>; t++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(block[t] == queue_front(&amp;<span class="built_in">queue</span>) &amp;&amp; !current_in_block(block,page_index[i]))&#123;</span><br><span class="line">				block[t] = page_index[i];</span><br><span class="line">				queue_pop(&amp;<span class="built_in">queue</span>);</span><br><span class="line">				queue_push(&amp;<span class="built_in">queue</span>, page_index[i]);</span><br><span class="line">				r_times++;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">size_t</span> t = <span class="number">0</span>; t &lt; <span class="number">3</span>; t++)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,block[t]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;r_times=%d\n&quot;</span>,r_times);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 假设系统为某进程分配三个物理块，并考虑有以下打页面引用顺序</span></span><br><span class="line">	<span class="keyword">int</span> page_index[<span class="number">20</span>] = &#123;</span><br><span class="line">		<span class="number">7</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,\</span><br><span class="line">		<span class="number">0</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">1</span> \</span><br><span class="line">	&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 系统为该进程分配了三个物理块</span></span><br><span class="line">	<span class="keyword">int</span> block[<span class="number">3</span>] =&#123;<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 使用FIFO算法进行页面置换</span></span><br><span class="line">	FIFO(page_index,block);</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">root@SENCOM:~&#x2F;Code&#x2F;OS&#x2F;Page_Replacement_Algorithms# gcc queue.c FIFO.c &amp;&amp; .&#x2F;a.out</span><br><span class="line">7 -1 -1 </span><br><span class="line">7 0 -1 </span><br><span class="line">7 0 1 </span><br><span class="line">2 0 1 </span><br><span class="line">2 0 1 </span><br><span class="line">2 3 1 </span><br><span class="line">2 3 0 </span><br><span class="line">4 3 0 </span><br><span class="line">4 2 0 </span><br><span class="line">4 2 3 </span><br><span class="line">0 2 3 </span><br><span class="line">0 2 3 </span><br><span class="line">0 2 3 </span><br><span class="line">0 1 3 </span><br><span class="line">0 1 2 </span><br><span class="line">0 1 2 </span><br><span class="line">0 1 2 </span><br><span class="line">7 1 2 </span><br><span class="line">7 0 2 </span><br><span class="line">7 0 1 </span><br><span class="line">r_times&#x3D;12</span><br></pre></td></tr></table></figure>

<p>本测试用例在OPT算法下需要进行6次页面置换，而在FIFO算法下需要12次。</p>
<p>当我们增加Block大小后，FIFO算法下本用例的页面置换次数并不一定会降低，我们称这种现象叫做<strong>Belady异常</strong>。</p>
<h2 id="3、最近最少使用置换算法-LRU"><a href="#3、最近最少使用置换算法-LRU" class="headerlink" title="3、最近最少使用置换算法(LRU)"></a>3、最近最少使用置换算法(LRU)</h2><p>FIFO算法的性能之所以差，是因为它所依据的条件是各个页面调入内存的时间，而页面调入的先后并不能反映页面的使用情况。最近最久未使用（LRU）的页面置换算法是根据页面调入内存后的使用情况做出决策的。由于无法预测各页面将来的使用情况，只能利用“最近的过去”作为“最近的将来”的近似，因此，LRU置换算法选择的是最久未使用的页面予以淘汰。该算法赋予每个页面一个访问字段，用来记录一个页面上次被访问以来所经历的时间t。当需要淘汰一个页面时，选择现有页面中其t值最大的，即最近最久未使用的页面予以淘汰即可。</p>
<p>LRU.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 页面置换算法之最近最久未使用页面置换算法</span></span><br><span class="line"><span class="comment"> * Michael Jiang</span></span><br><span class="line"><span class="comment"> * Sun 06 Oct 2019 08:58:30 AM CST</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Page</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> id;</span><br><span class="line">	<span class="keyword">int</span> time;</span><br><span class="line">&#125;Page;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">current_in_block</span><span class="params">(<span class="keyword">int</span> *block, <span class="keyword">int</span> current)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(current == block[i])&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_blok</span><span class="params">(<span class="keyword">int</span> *block)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;当前Block：&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,block[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自增方法，使在block中的page time全部自增1</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">auto_increment</span><span class="params">(Page *page,<span class="keyword">int</span> *block)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(block[i] != <span class="number">-1</span>)&#123;</span><br><span class="line">			page[block[i]].time++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* LRU 页面置换算法</span></span><br><span class="line"><span class="comment"> * @param page_index:进程使用的页面序列</span></span><br><span class="line"><span class="comment"> * @param block:进程分配到的物理块</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LRU</span><span class="params">(<span class="keyword">int</span> now_page, <span class="keyword">int</span> *block,Page *page)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;time:%d %d %d\n&quot;</span>,page[block[<span class="number">0</span>]].time,page[block[<span class="number">1</span>]].time,page[block[<span class="number">2</span>]].time);</span><br><span class="line">	<span class="comment">// 找出time值最大的页</span></span><br><span class="line">	<span class="keyword">int</span> max_time = page[block[<span class="number">0</span>]].time;</span><br><span class="line">	<span class="keyword">int</span> max_page = block[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">int</span> max_index = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">1</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(page[block[i]].time &gt; max_time)&#123;</span><br><span class="line">			max_time = page[block[i]].time;</span><br><span class="line">			max_page = block[i];</span><br><span class="line">			max_index = i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;新页%d换出旧页%d\n&quot;</span>,now_page,max_page);</span><br><span class="line">	<span class="comment">// 换出 time 最大的页</span></span><br><span class="line">	block[max_index] = now_page;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 重置time</span></span><br><span class="line">	page[max_page].time = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> ** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Page page[<span class="number">20</span>];</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 初始化page</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++)&#123;</span><br><span class="line">		page[i].id = i;</span><br><span class="line">		page[i].time = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 假设系统为某进程分配三个物理块，并考虑有以下打页面引用顺序</span></span><br><span class="line">	<span class="keyword">int</span> page_index[<span class="number">20</span>] = &#123;</span><br><span class="line">		<span class="number">7</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,\</span><br><span class="line">		<span class="number">0</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">1</span> \</span><br><span class="line">	&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 系统为该进程分配了三个物理块</span></span><br><span class="line">	<span class="keyword">int</span> block[<span class="number">3</span>] =&#123;<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 先将前三个页调入Block</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">		block[i] = page_index[i];</span><br><span class="line">		auto_increment(page,block);</span><br><span class="line">		print_blok(block);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 执行后续页</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">3</span>; i &lt; <span class="number">20</span>; i++)&#123;</span><br><span class="line">		<span class="comment">// 打印当前block中的页编号</span></span><br><span class="line">		print_blok(block);</span><br><span class="line">		<span class="keyword">if</span>(current_in_block(block,page_index[i]))&#123;</span><br><span class="line">			<span class="comment">// 如果接下来的页在Block中的话我们就修改一下time</span></span><br><span class="line">			page[page_index[i]].time = <span class="number">0</span>;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;页%d存在于Block中，无需执行页面替换\n&quot;</span>,page_index[i]);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="comment">// 如果不再当前进程的Block中就需要调用LRU进行页面替换</span></span><br><span class="line">			LRU(page_index[i],block,page);</span><br><span class="line">		&#125;</span><br><span class="line">		auto_increment(page,block);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编译和执行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">root@SENCOM:~&#x2F;Code&#x2F;OS&#x2F;Page_Replacement_Algorithms# gcc LRU.c &amp;&amp; .&#x2F;a.out </span><br><span class="line">当前Block：7 -1 -1 </span><br><span class="line">当前Block：7 0 -1 </span><br><span class="line">当前Block：7 0 1 </span><br><span class="line">当前Block：7 0 1 </span><br><span class="line">time:3 2 1</span><br><span class="line">新页2换出旧页7</span><br><span class="line"></span><br><span class="line">当前Block：2 0 1 </span><br><span class="line">页0存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：2 0 1 </span><br><span class="line">time:2 1 3</span><br><span class="line">新页3换出旧页1</span><br><span class="line"></span><br><span class="line">当前Block：2 0 3 </span><br><span class="line">页0存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：2 0 3 </span><br><span class="line">time:4 1 2</span><br><span class="line">新页4换出旧页2</span><br><span class="line"></span><br><span class="line">当前Block：4 0 3 </span><br><span class="line">time:1 2 3</span><br><span class="line">新页2换出旧页3</span><br><span class="line"></span><br><span class="line">当前Block：4 0 2 </span><br><span class="line">time:2 3 1</span><br><span class="line">新页3换出旧页0</span><br><span class="line"></span><br><span class="line">当前Block：4 3 2 </span><br><span class="line">time:3 1 2</span><br><span class="line">新页0换出旧页4</span><br><span class="line"></span><br><span class="line">当前Block：0 3 2 </span><br><span class="line">页3存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：0 3 2 </span><br><span class="line">页2存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：0 3 2 </span><br><span class="line">time:3 2 1</span><br><span class="line">新页1换出旧页0</span><br><span class="line"></span><br><span class="line">当前Block：1 3 2 </span><br><span class="line">页2存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：1 3 2 </span><br><span class="line">time:2 4 1</span><br><span class="line">新页0换出旧页3</span><br><span class="line"></span><br><span class="line">当前Block：1 0 2 </span><br><span class="line">页1存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：1 0 2 </span><br><span class="line">time:1 2 3</span><br><span class="line">新页7换出旧页2</span><br><span class="line"></span><br><span class="line">当前Block：1 0 7 </span><br><span class="line">页0存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：1 0 7 </span><br><span class="line">页1存在于Block中，无需执行页面替换</span><br></pre></td></tr></table></figure>

<h2 id="4、时钟置换算法-CLOCK"><a href="#4、时钟置换算法-CLOCK" class="headerlink" title="4、时钟置换算法(CLOCK)"></a>4、时钟置换算法(CLOCK)</h2><p>虽然LRU是一种较好的算法，但由于它要求较多的硬件支持，使得其实现所需的成本过高，故在实际应用中，大多采用LRU的类似算法。Clock算法就是用的较多的一种LRU近似算法。</p>
<p>首先介绍一下<strong>简单Clock算法</strong>，只需要为每页设置一位访问位，再将内存中的所有页面都通过链接指针链接成一个循环队列。当某页被访问时，其访问位被置1。置换算法在选择一页淘汰时，只需检查访问位。如果是0，就选择该页换出，若为1，则重新将它置0，暂不换出，给予第二次驻留机会。再按照FIFO算法检查下一个页面。当检查到队列的最后一个页面时若其访问位仍为1，则返回队首去检查的一个页面。<strong>所以最坏的情况下要进行两轮扫描才能找到合适的淘汰页面。</strong></p>
<p>clock.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 页面置换算法之简单Clock页面置换算法</span></span><br><span class="line"><span class="comment"> * Michael Jiang</span></span><br><span class="line"><span class="comment"> * Sat 05 Oct 2019 10:32:10 AM CST</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 页的数据结构</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Page</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> id;		<span class="comment">// 页面编号</span></span><br><span class="line">	<span class="keyword">bool</span> access;<span class="comment">// 该页是否被访问</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;Page;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">current_in_block</span><span class="params">(<span class="keyword">int</span> *block, <span class="keyword">int</span> current)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(current == block[i])&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_blok</span><span class="params">(<span class="keyword">int</span> *block)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;当前Block：&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,block[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 简单的 Clock 置换算法</span></span><br><span class="line"><span class="comment"> * @param page_index:进程使用的页面序列</span></span><br><span class="line"><span class="comment"> * @param block:进程分配到的物理块</span></span><br><span class="line"><span class="comment"> * @param page:Page数据结构</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">clock</span><span class="params">(<span class="keyword">int</span> new_page, <span class="keyword">int</span> *block, Page **current, Page *page)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 找出合适的换出页</span></span><br><span class="line">	<span class="keyword">while</span>((*current)-&gt;access != <span class="number">0</span>)&#123;</span><br><span class="line">		(*current)-&gt;access = <span class="number">0</span>;</span><br><span class="line">		(*current) = (*current)-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;读入新页编号%d;换出的页编号:%d\n&quot;</span>,new_page,(*current)-&gt;id);</span><br><span class="line">	<span class="comment">// 将current指向的页面换出</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(block[i] == (*current)-&gt;id)&#123;</span><br><span class="line">			block[i] = new_page; <span class="comment">//换上新页</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 修改循环队列</span></span><br><span class="line">			page[new_page].access = <span class="number">1</span>;</span><br><span class="line">			page[new_page].id = new_page;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// 找到current的前节点</span></span><br><span class="line">			Page *p = (*current);</span><br><span class="line">			<span class="keyword">int</span> step = <span class="number">2</span>;</span><br><span class="line">			<span class="keyword">while</span>(step--)&#123;</span><br><span class="line">				p = p-&gt;next;</span><br><span class="line">			&#125;</span><br><span class="line">			page[new_page].next = (*current)-&gt;next;</span><br><span class="line">			(*current) = &amp;page[new_page];</span><br><span class="line">			p-&gt;next = (*current);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 假设系统为某进程分配三个物理块，并考虑有以下的页面引用顺序</span></span><br><span class="line">	<span class="keyword">int</span> page_index[<span class="number">20</span>] = &#123;</span><br><span class="line">		<span class="number">7</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,\</span><br><span class="line">		<span class="number">0</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">1</span> \</span><br><span class="line">	&#125;;</span><br><span class="line">	</span><br><span class="line">	Page page[<span class="number">20</span>];</span><br><span class="line">	Page *current;</span><br><span class="line">	Page *p;</span><br><span class="line">	<span class="comment">// 系统为该进程分配了三个物理块</span></span><br><span class="line">	<span class="keyword">int</span> block[<span class="number">3</span>] =&#123;<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 首先将前三个页放到Block中</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">		block[i] = page_index[i];</span><br><span class="line">		page[page_index[i]].access = <span class="literal">true</span>;</span><br><span class="line">		page[page_index[i]].id = page_index[i];</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">0</span>)&#123;</span><br><span class="line">			current = &amp;page[page_index[i]];</span><br><span class="line">			p = &amp;page[page_index[i]];</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			p-&gt;next=&amp;page[page_index[i]];</span><br><span class="line">			p = &amp;page[page_index[i]];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	p-&gt;next = current;<span class="comment">// 形成循环队列，current指向队头</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 使用简单clock算法进行页面置换</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">3</span>; i &lt; <span class="number">20</span>; i++)&#123;			</span><br><span class="line">		<span class="comment">// 打印当前block中的页编号</span></span><br><span class="line">		print_blok(block);</span><br><span class="line">		<span class="comment">// 首先判断接下来的页面是否在Block中</span></span><br><span class="line">		<span class="keyword">if</span>(current_in_block(block,page_index[i]))&#123;</span><br><span class="line">			<span class="comment">// 如果接下来的页在Block中的话我们就修改一下访问位就OK</span></span><br><span class="line">			page[page_index[i]].access = <span class="literal">true</span>;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;页%d存在于Block中，无需执行页面替换\n&quot;</span>,page_index[i]);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="comment">// 如果不再当前进程的Block中就需要调用clock进行页面替换</span></span><br><span class="line">			clock(page_index[i],block,&amp;current, page);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编译和执行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">root@SENCOM:~&#x2F;Code&#x2F;OS&#x2F;Page_Replacement_Algorithms# gcc clock.c &amp;&amp; .&#x2F;a.out </span><br><span class="line">当前Block：7 0 1 </span><br><span class="line">读入新页编号2;换出的页编号:7</span><br><span class="line"></span><br><span class="line">当前Block：2 0 1 </span><br><span class="line">页0存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：2 0 1 </span><br><span class="line">读入新页编号3;换出的页编号:1</span><br><span class="line"></span><br><span class="line">当前Block：2 0 3 </span><br><span class="line">页0存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：2 0 3 </span><br><span class="line">读入新页编号4;换出的页编号:2</span><br><span class="line"></span><br><span class="line">当前Block：4 0 3 </span><br><span class="line">读入新页编号2;换出的页编号:3</span><br><span class="line"></span><br><span class="line">当前Block：4 0 2 </span><br><span class="line">读入新页编号3;换出的页编号:4</span><br><span class="line"></span><br><span class="line">当前Block：3 0 2 </span><br><span class="line">页0存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：3 0 2 </span><br><span class="line">页3存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：3 0 2 </span><br><span class="line">页2存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：3 0 2 </span><br><span class="line">读入新页编号1;换出的页编号:3</span><br><span class="line"></span><br><span class="line">当前Block：1 0 2 </span><br><span class="line">页2存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：1 0 2 </span><br><span class="line">页0存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：1 0 2 </span><br><span class="line">页1存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：1 0 2 </span><br><span class="line">读入新页编号7;换出的页编号:1</span><br><span class="line"></span><br><span class="line">当前Block：7 0 2 </span><br><span class="line">页0存在于Block中，无需执行页面替换</span><br><span class="line"></span><br><span class="line">当前Block：7 0 2 </span><br><span class="line">读入新页编号1;换出的页编号:2</span><br></pre></td></tr></table></figure>

<p>最后提一下<strong>改进型Clock置换算法</strong>，将一个页面换出时，如果该页面已被修改过，便必须将该页重新写回到磁盘上;但如果该页未被修改过，则不必将它拷回磁盘。换言之，对于修改过的页面，在换出时所付出的开销比未修改的页面大。在改进型的Clock算法中，除须考虑页面的使用情况外，还需增加一个因素——置换代价。由访问位A和修改位M可以组合成下面四种类型的页面：</p>
<p>1类(A=0,M=0)：表示该页面最近既未被访问，又未被修改，是最佳淘汰页。</p>
<p>2类(A=0,M=1)：表示该页面最近未被访问，但已被修改，并不是很好的淘汰页。</p>
<p>3类(A=1,M=0)：表示该页最近已被访问，但未被修改，该页可能再次被访问。</p>
<p>4类(A=1,B=1)：表示最近已被访问且被修该，该页可能再被访问。</p>
<p>在内存中的每一页，都必定是这四类页之一。在进行页面置换时，可采用与简单Clock算法类似的算法，其差别在于该算法必须同时检查访问位和修改位，以确定该页属于四类叶中的哪一种。其执行步骤可分成一下三步：</p>
<p>（一）从指针所指示的当前位置开始，扫描循环队列，寻找A=0,M=0的第一类页面，将所有遇到的第一个页面作为所选中的淘汰页。在第一次扫描期间不改变访问位A。</p>
<p>（二）如果第一步失败，即查找一轮后未遇到第一类页面，则开始第二轮扫描，寻找A=0，M=1的第二类页面，将所遇到的第一个这类页面作为淘汰页。在第二轮扫描期间，将所有的扫描过的页面的访问位都置0。</p>
<p>（三）如果第二步失败，亦即未找到第二类页面，则旧将指针返回到开始的位置，并将所有的访问位复0。然后重复第一步，即寻找A=0，M=0的第一类页面，如果仍失败，必要时重复第二步。寻找A=0,M=1的第二类页面，此时就一定能够找到被淘汰的页。</p>
<p>该算法与简单Clock算法比较，可减少磁盘的I/O操作次数，但为了找到一个可置换的页，可能须经过几轮扫描。换言之，实现该算法本身的开销将有所增加。</p>
<p>改进型Clcok算法只需在原Clock算法的基础上进行简单修改即可，这里就不给出该算法的实现了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/10/06/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B%E9%A1%B5%E9%9D%A2%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95-OPT%EF%BC%8CFIFO%EF%BC%8CLRU%EF%BC%8CCLOCK/" data-id="cknhk87770000xgtv05ni9y0x" data-title="操作系统之页面置换算法-OPT，FIFO，LRU，CLOCK" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algo/" rel="tag">algo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Debian瞎折腾系列-软件更新和显卡驱动问题" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/10/03/Debian%E7%9E%8E%E6%8A%98%E8%85%BE%E7%B3%BB%E5%88%97-%E8%BD%AF%E4%BB%B6%E6%9B%B4%E6%96%B0%E5%92%8C%E6%98%BE%E5%8D%A1%E9%A9%B1%E5%8A%A8%E9%97%AE%E9%A2%98/" class="article-date">
  <time class="dt-published" datetime="2019-10-03T14:42:25.000Z" itemprop="datePublished">2019-10-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/10/03/Debian%E7%9E%8E%E6%8A%98%E8%85%BE%E7%B3%BB%E5%88%97-%E8%BD%AF%E4%BB%B6%E6%9B%B4%E6%96%B0%E5%92%8C%E6%98%BE%E5%8D%A1%E9%A9%B1%E5%8A%A8%E9%97%AE%E9%A2%98/">Debian瞎折腾系列-软件更新和显卡驱动问题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>折腾源于热爱！由于国庆回家忘记携带我的笔记本电脑的电源适配器，所以只好把原来的HP微机（No. s5-1113cx）零件攒起来，还行可以开机。</p>
<p>本来准备跑个Kali Live之类的U盘系统将就用用呗，突然想到2018年春节时用这台电脑在一个80GB的硬盘上安装了一个CentOS吧？？？</p>
<p>找出来塞到主机里面，这个硬盘读盘叫声让人害怕（感觉下一秒就要挂掉）</p>
<p>本以为是CentOS没想到居然是带有Windows 壁纸的Debian！！！！还是xfce桌面漂亮又好用，Debian爱好者的莫名感动。</p>
<p><img src="/images/P91001-211215.jpg" alt="img"></p>
<p>来一波软件更新吧，首先来熟悉一下apt包管理器吧，好长时间都没用了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">root@SENCOM:~# apt </span><br><span class="line">apt 1.8.2 (i386)</span><br><span class="line">用法： apt [选项] 命令</span><br><span class="line"></span><br><span class="line">命令行软件包管理器 apt 提供软件包搜索，管理和信息查询等功能。</span><br><span class="line">它提供的功能与其他 APT 工具相同（像 apt-get 和 apt-cache），</span><br><span class="line">但是默认情况下被设置得更适合交互。</span><br><span class="line"></span><br><span class="line">常用命令：</span><br><span class="line">  list - 根据名称列出软件包</span><br><span class="line">  search - 搜索软件包描述</span><br><span class="line">  show - 显示软件包细节</span><br><span class="line">  install - 安装软件包</span><br><span class="line">  reinstall - reinstall packages</span><br><span class="line">  remove - 移除软件包</span><br><span class="line">  autoremove - 卸载所有自动安装且不再使用的软件包</span><br><span class="line">  update - 更新可用软件包列表</span><br><span class="line">  upgrade - 通过 安装&#x2F;升级 软件来更新系统</span><br><span class="line">  full-upgrade - 通过 卸载&#x2F;安装&#x2F;升级 来更新系统</span><br><span class="line">  edit-sources - 编辑软件源信息文件</span><br><span class="line"></span><br><span class="line">参见 apt(8) 以获取更多关于可用命令的信息。</span><br><span class="line">程序配置选项及语法都已经在 apt.conf(5) 中阐明。</span><br><span class="line">欲知如何配置软件源，请参阅 sources.list(5)。</span><br><span class="line">软件包及其版本偏好可以通过 apt_preferences(5) 来设置。</span><br><span class="line">关于安全方面的细节可以参考 apt-secure(8).</span><br><span class="line">                                         本 APT 具有超级牛力。</span><br></pre></td></tr></table></figure>

<p><strong>apt update</strong>：将远程软件库和本地软件库做对比，检查哪些软件可以更新，以及软件包依赖关系，给出一个分析报告。只检查不更新。<br> <strong>apt upgrade</strong>：在执行upgrade 之前要先执行update ，根据update的分析报告去下载并更新软件。在以下几种情况，某个待升级的软件包不会被升级。</p>
<p>新软件包和系统的某个软件包有冲突<br> 新软件包有新的依赖，但系统不满足依赖<br> 安装新软件包时，要求先移除旧的软件包</p>
<p><strong>apt dist-upgrade</strong>：在执行dist-upgrade 之前也要先执行update ，dist-upgrade 包含upgrade，同时增添了以下功能：</p>
<p>可以智能处理新软件包的依赖<br> 智能冲突解决系统<br> 安装新软件包时，可以移除旧软件包，但不是所有软件都可以。</p>
<p><strong>apt full-upgrade</strong>：在执行full-upgrade 之前也要先执行update ，升级整个系统，必要时可以移除旧软件包。</p>
<p>注意：如果出现update有可用更新而执行upgrade却无法更新的情况下可以试一试dist-upgrade</p>
<p>最好将apt源改为国内的源这样速度不是快一点两点，简直就是板车和火箭的区别。</p>
<p>结果更新结束重启机子马上就感觉不对劲了，分辨率变成700×400了，xrandr看一下只有700×400这一个选项，估计是显卡驱动没有装上</p>
<p>我去，linux最烦的就是显卡驱动的安装了</p>
<p>AMD官网走一波，顺利的下载了对应的驱动尝试安装一下</p>
<p><img src="/images/P91003-201741.jpg" alt="img"></p>
<p>还嫌XServer版本高？真是糟糕，去网上找了找没发现什么好的解决方案。</p>
<p>咦？为何不试一试开源的通用驱动呢？找一下，还真的有，还是Debain官网的教程</p>
<p><a target="_blank" rel="noopener" href="https://wiki.debian.org/AtiHowTo">https://wiki.debian.org/AtiHowTo</a></p>
<p>按照上面的<strong>Installation</strong> 走一趟真的就修复了！</p>
<p><img src="/images/qq81515sd1s5ad15sad15.png" alt="img"></p>
<p>显示效果好多了。一晚上就折腾它了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/10/03/Debian%E7%9E%8E%E6%8A%98%E8%85%BE%E7%B3%BB%E5%88%97-%E8%BD%AF%E4%BB%B6%E6%9B%B4%E6%96%B0%E5%92%8C%E6%98%BE%E5%8D%A1%E9%A9%B1%E5%8A%A8%E9%97%AE%E9%A2%98/" data-id="cknhke2cj00004ktvh34r6avh" data-title="Debian瞎折腾系列-软件更新和显卡驱动问题" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/debian/" rel="tag">debian</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/error/" rel="tag">error</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-使用Bochs体验Linux0-11" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/09/29/%E4%BD%BF%E7%94%A8Bochs%E4%BD%93%E9%AA%8CLinux0-11/" class="article-date">
  <time class="dt-published" datetime="2019-09-29T14:47:16.000Z" itemprop="datePublished">2019-09-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/09/29/%E4%BD%BF%E7%94%A8Bochs%E4%BD%93%E9%AA%8CLinux0-11/">使用Bochs体验Linux0.11</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>最近比较膨胀准备再次向Linux0.11源码发起挑战。</p>
<p>直接读源码？不可取，拿出赵炯博士写的《Linux内核完全注释》重新学习一下。</p>
<p>这次希望能够在本学期内把它读完！</p>
<p>理论与实践要结合；天天看0.11源码都没体验过Linux0.11系统，有什么意思？</p>
<p>于是赵炯博士为我们提供了一个编译好的0.11镜像和模拟器。</p>
<p><a target="_blank" rel="noopener" href="http://www.oldlinux.org/Linux.old/bochs/linux-0.11-devel-040329.zip">http://www.oldlinux.org/Linux.old/bochs/linux-0.11-devel-040329.zip</a></p>
<p>首先去上面的地址下载工具（包含模拟器和镜像）</p>
<p>这里我将它解压在<code>C:\Program Files (x86)</code></p>
<p>然后执行如下命令即可启动！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files (x86)\Bochs-2.1.1&gt;bochs.exe -q -f bochsrc-hd.bxrc</span><br></pre></td></tr></table></figure>

<p><img src="/images/20190929212314.png" alt="img"></p>
<p>愉快的玩耍咯！</p>
<hr>
<p>这里立一下OS学习的一些计划：</p>
<p>这学期会更新一些关于<strong>进程管理</strong>，<strong>内存管理</strong>，<strong>文件管理</strong>等有关OS的简单实现（使用C语言）</p>
<p>上一篇不就是我的OS学习开篇嘛？</p>
<p>国庆期间不出意外会出进程调度相关的初代代码，为什么是初代？因为这个调度涉及的几个算法（FCFS，SJF，SP，HRRN， RR）我不能保证国庆内全部完成。</p>
<p>by the way,推荐一部纪录片-&gt;<a target="_blank" rel="noopener" href="https://movie.douban.com/subject/1437389/">Revolution OS (2001)</a>;片中的Gates简直就被怼成开源世界的敌人，处处攻击开源世界。但是看看现在市值第一的微软收购了GitHub现在自家的田牌系统居然内置了WSL，开源了早期的田牌系统的文件管理器和Win10的计算器源代码！！！发起了许多开源项目！！！话说新的Terminal真滴漂亮。</p>
<p>现在Linux商业化第一梯队的RedHat，现在脸也不要了只剩一个红帽子了（调侃一下新Logo蛤蛤），最终难逃被IBM收购。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/09/29/%E4%BD%BF%E7%94%A8Bochs%E4%BD%93%E9%AA%8CLinux0-11/" data-id="cknhkjrmq0000astv9vk7bd32" data-title="使用Bochs体验Linux0.11" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-初试Finiate-Automata之简单正则匹配" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/09/22/%E5%88%9D%E8%AF%95Finiate-Automata%E4%B9%8B%E7%AE%80%E5%8D%95%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D/" class="article-date">
  <time class="dt-published" datetime="2019-09-22T15:02:13.000Z" itemprop="datePublished">2019-09-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/09/22/%E5%88%9D%E8%AF%95Finiate-Automata%E4%B9%8B%E7%AE%80%E5%8D%95%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D/">初试Finiate Automata之简单正则匹配</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Why Study Automata Theory<br> There are several reasons why the study of automata and complexity is an<br> important part of the core of Computer Science…</p>
</blockquote>
<p>摘自John E. Hopcroft, Rajeev Motwani, Jeffrey D. Ullman-Introduction to Automata Theory, Languages, and Computations-Prentice Hall (2006)</p>
<p>对于 Finiate Automata按照转移函数的不同可以分为<strong>确定型有穷自动机（Determinism Finite Automate, DFA）</strong>，与<strong>非确定型有穷自动机（Non-determinism Finite Automate, NFA）</strong>。<br> 本次主要拿DFA来练练手，不要一上来就想搞个大新闻 ，要由浅入深，循序渐进的学习，这样才能闷声发大财。</p>
<p>所以不要认为这些Too Young Too Simple 的东西不值一提，作为码农要提高自己的姿势水平。你们啊Navie</p>
<p>看题目：</p>
<blockquote>
<p>// 考虑仅由字母{a, b}组成的字符串，要求字符串中字母b必须成对出现，<br> // 否则字符串非法。这个规则实现起来其实非常简单，不需要自动机也完全可以。<br> // 但是我们考虑使用自动机来进行判断。顺便，该规则的正规表达式描述是：(a|bb)*。<br> // 星号运算代表重复若干次，包括零次。</p>
</blockquote>
<p>根据题目要求可以得出以下DFA有向图：</p>
<p><img src="/images/20190922083722.png" alt="img"></p>
<p>可知只有0号状态才是合法的。</p>
<p>程序初始为0状态，然后根据读入的字符进行状态变化，最终的状态若回到0就代表输入的字符串符合表达式要求，若为其他状态则不符合要求。</p>
<p>那么用什么来表达这种数据结构呢？</p>
<p>首先想到的就是邻接矩阵啊，用它来存储图还是比较方便的蛤蛤！</p>
<p>但在实际操作的过程中发现对于2号状态有两条从自己出发指向自己的弧，这种情况使用邻接矩阵就不是很容易表示了。所以果断放弃邻接矩阵方式存储，</p>
<p>转而选用邻接表来存储这个DFA有向图。</p>
<p><img src="/images/20190922ndidnbaisdnias.png" alt="img"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  @Authour : Michael Jiang 2019年9月22日</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LinkNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">char</span> weight;                <span class="comment">//状态之间转换的条件</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">headNode</span> *<span class="title">nextStatus</span>;</span><span class="comment">//下一个状态的节点</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">LinkNode</span> *<span class="title">next</span>;</span>      <span class="comment">//下一个同弧尾节点</span></span><br><span class="line">    LinkNode(<span class="keyword">char</span> w, headNode *ns):  </span><br><span class="line">        weight(w),nextStatus(ns),next(<span class="literal">NULL</span>)&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">headNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> statusID;               <span class="comment">//状态标志</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">LinkNode</span> *<span class="title">next</span>;</span>      <span class="comment">//从该状态指出的所有弧节点</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">    headNode *head = <span class="keyword">new</span> headNode[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成相应的确定性有穷自动机</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">makeDFA</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        head[i].statusID = i;</span><br><span class="line">    &#125;</span><br><span class="line">    LinkNode *p;</span><br><span class="line">    p = <span class="keyword">new</span> LinkNode(<span class="string">&#x27;a&#x27;</span>, &amp;head[<span class="number">0</span>]);</span><br><span class="line">    head[<span class="number">0</span>].next = p;</span><br><span class="line">    p-&gt;next = <span class="keyword">new</span> LinkNode(<span class="string">&#x27;b&#x27;</span>, &amp;head[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    p = <span class="keyword">new</span> LinkNode(<span class="string">&#x27;b&#x27;</span>, &amp;head[<span class="number">0</span>]);</span><br><span class="line">    head[<span class="number">1</span>].next = p;</span><br><span class="line">    p-&gt;next = <span class="keyword">new</span> LinkNode(<span class="string">&#x27;a&#x27;</span>, &amp;head[<span class="number">2</span>]);</span><br><span class="line">    </span><br><span class="line">    p = <span class="keyword">new</span> LinkNode(<span class="string">&#x27;a&#x27;</span>, &amp;head[<span class="number">2</span>]);</span><br><span class="line">    head[<span class="number">2</span>].next = p;</span><br><span class="line">    p-&gt;next = <span class="keyword">new</span> LinkNode(<span class="string">&#x27;b&#x27;</span>, &amp;head[<span class="number">2</span>]);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断输入的字符串str是否符合规则</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isLegal</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> nowStatus = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(str);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        LinkNode *p;      </span><br><span class="line">        p = head[nowStatus].next;</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="keyword">if</span>(p-&gt;weight == str[i])&#123;            </span><br><span class="line">                nowStatus = p-&gt;nextStatus-&gt;statusID;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            p = p-&gt;next;</span><br><span class="line">        &#125;    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> nowStatus==<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *str[<span class="number">6</span>] =&#123;</span><br><span class="line">         <span class="string">&quot;abb&quot;</span>,</span><br><span class="line">         <span class="string">&quot;aaabb&quot;</span>,</span><br><span class="line">         <span class="string">&quot;bbaa&quot;</span>,</span><br><span class="line">         <span class="string">&quot;bab&quot;</span>,</span><br><span class="line">         <span class="string">&quot;aba&quot;</span>,</span><br><span class="line">         <span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//构造确定性有穷自动机</span></span><br><span class="line">    makeDFA();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;str[%d] = %s \t: isLegal=%d\t\n&quot;</span>,i,str[i],isLegal(str[i]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Michael Jiang\Desktop\Automata&gt;g++ main.cpp &amp;&amp; a.exe</span><br><span class="line">str[0] &#x3D; abb    : isLegal&#x3D;1</span><br><span class="line">str[1] &#x3D; aaabb  : isLegal&#x3D;1</span><br><span class="line">str[2] &#x3D; bbaa   : isLegal&#x3D;1</span><br><span class="line">str[3] &#x3D; bab    : isLegal&#x3D;0</span><br><span class="line">str[4] &#x3D; aba    : isLegal&#x3D;0</span><br><span class="line">str[5] &#x3D;        : isLegal&#x3D;1</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/09/22/%E5%88%9D%E8%AF%95Finiate-Automata%E4%B9%8B%E7%AE%80%E5%8D%95%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D/" data-id="cknhl3asr0000jktvcx4ygugk" data-title="初试Finiate Automata之简单正则匹配" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algo/" rel="tag">algo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Git基本操作之branch与merge" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/09/22/Git%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E4%B9%8Bbranch%E4%B8%8Emerge/" class="article-date">
  <time class="dt-published" datetime="2019-09-22T14:58:19.000Z" itemprop="datePublished">2019-09-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/09/22/Git%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E4%B9%8Bbranch%E4%B8%8Emerge/">Git基本操作之branch与merge</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>还是拿上次的哪个GitTest项目进行学习branch和merge操作。</p>
<p>在操作之前我已经将项目pull回本地的gittest目录下面了。</p>
<p><strong>1.查看当前有哪些branch</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Michael Jiang@DESKTOP-JUOEVVQ MINGW64 ~&#x2F;Desktop&#x2F;gittest (master)</span><br><span class="line">$ git branch</span><br><span class="line">* master</span><br></pre></td></tr></table></figure>

<p>可以看出只有master</p>
<p><strong>2.新建一个名为test1 的分支</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Michael Jiang@DESKTOP-JUOEVVQ MINGW64 ~&#x2F;Desktop&#x2F;gittest (master)</span><br><span class="line">$ git branch test1</span><br></pre></td></tr></table></figure>

<p><strong>3.切换到test1分支</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Michael Jiang@DESKTOP-JUOEVVQ MINGW64 ~&#x2F;Desktop&#x2F;gittest (master)</span><br><span class="line">$ git checkout test1</span><br><span class="line">Switched to branch &#39;test1&#39;</span><br><span class="line"></span><br><span class="line">Michael Jiang@DESKTOP-JUOEVVQ MINGW64 ~&#x2F;Desktop&#x2F;gittest (test1)</span><br><span class="line">$</span><br></pre></td></tr></table></figure>

<p>可以看出当前位置已经从master切换到test1了</p>
<p>【当然你也可以一键创建分支和切换branch】命令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$git checkout -b test1</span><br></pre></td></tr></table></figure>

<p><strong>4.修改branch的名字</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Michael Jiang@DESKTOP-JUOEVVQ MINGW64 ~&#x2F;Desktop&#x2F;gittest (test1)</span><br><span class="line">$ git branch -m test1 test1.0</span><br><span class="line"></span><br><span class="line">Michael Jiang@DESKTOP-JUOEVVQ MINGW64 ~&#x2F;Desktop&#x2F;gittest (test1.0)</span><br><span class="line">$</span><br></pre></td></tr></table></figure>

<p>可以看出已经成功将branch的名字从test1改为test1.0</p>
<hr>
<p>接下来对test1.0分支的代码进行一些修改</p>
<p>这个项目从master分支过来时只有两个文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bigChange.sen</span><br><span class="line">hello.md</span><br></pre></td></tr></table></figure>

<p>现在在分支中添加一个新文件sayHello.py并修改了hello.md中的内容。</p>
<p>然后执行了add 和 commit</p>
<p>接下来就进行合并？</p>
<p>合并前突发奇想不如push一下branch版吧</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Michael Jiang@DESKTOP-JUOEVVQ MINGW64 ~&#x2F;Desktop&#x2F;gittest (test1.0)</span><br><span class="line">$ git push origin test1.0</span><br><span class="line">Enumerating objects: 6, done.</span><br><span class="line">Counting objects: 100% (6&#x2F;6), done.</span><br><span class="line">Delta compression using up to 6 threads</span><br><span class="line">Compressing objects: 100% (2&#x2F;2), done.</span><br><span class="line">Writing objects: 100% (4&#x2F;4), 368 bytes | 184.00 KiB&#x2F;s, done.</span><br><span class="line">Total 4 (delta 0), reused 0 (delta 0)</span><br><span class="line">remote:</span><br><span class="line">remote: Create a pull request for &#39;test1.0&#39; on GitHub by visiting:</span><br><span class="line">remote:      https:&#x2F;&#x2F;github.com&#x2F;MichaelJiang1997&#x2F;GitTest&#x2F;pull&#x2F;new&#x2F;test1.0</span><br><span class="line">remote:</span><br><span class="line">To github.com:MichaelJiang1997&#x2F;GitTest.git</span><br><span class="line"> * [new branch]      test1.0 -&gt; test1.0</span><br></pre></td></tr></table></figure>

<p>嗯。。。去Github瞅瞅（最近访问GitHub有点困难）</p>
<p><img src="/images/20190922143513.png" alt="img"></p>
<p>稳！</p>
<p>合并合并！！！</p>
<p>首先切换到想要合并到的分枝下，运行’git merge’命令 （例如本例中将test1.0分支合并到master分支的话，进入master分支运行git merge test1.0命令）如果合并顺利的话：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Michael Jiang@DESKTOP-JUOEVVQ MINGW64 ~&#x2F;Desktop&#x2F;gittest (master)</span><br><span class="line">$ git merge test1.0</span><br><span class="line">Updating d4b58f7..7b9fe0b</span><br><span class="line">Fast-forward</span><br><span class="line"> Hello.md    | 4 +++-</span><br><span class="line"> sayHello.py | 1 +</span><br><span class="line"> 2 files changed, 4 insertions(+), 1 deletion(-)</span><br><span class="line"> create mode 100644 sayHello.py</span><br></pre></td></tr></table></figure>

<p>合并成功。</p>
<p>在主分支git log一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Michael Jiang@DESKTOP-JUOEVVQ MINGW64 ~&#x2F;Desktop&#x2F;gittest (master)</span><br><span class="line">$ git log</span><br><span class="line">commit 7b9fe0b7b246653ab822b6824b9157244ea0a983 (HEAD -&gt; master, origin&#x2F;test1.0, origin&#x2F;master, test1.0)</span><br><span class="line">Author: MichaelJiang1997 &lt;592348268@qq.com&gt;</span><br><span class="line">Date:   Sun Sep 22 14:27:32 2019 +0800</span><br><span class="line"></span><br><span class="line">    add say hello</span><br><span class="line"></span><br><span class="line">commit d4b58f7e7b2cc676aefe2aaf50e8cbfd2742eb6d</span><br><span class="line">Author: MichaelJiang1997 &lt;592348268@qq.com&gt;</span><br><span class="line">Date:   Sun Sep 15 16:20:15 2019 +0800</span><br><span class="line"></span><br><span class="line">    测试改动</span><br><span class="line"></span><br><span class="line">commit 5e3f81db2777533ff78c28b94af987a0f81c4e11</span><br><span class="line">Author: MichaelJiang1997 &lt;592348268@qq.com&gt;</span><br><span class="line">Date:   Sun Sep 15 15:40:04 2019 +0800</span><br><span class="line"></span><br><span class="line">    test</span><br></pre></td></tr></table></figure>

<p>OK！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/09/22/Git%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E4%B9%8Bbranch%E4%B8%8Emerge/" data-id="cknhkxto00000qwtvccalbt7y" data-title="Git基本操作之branch与merge" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/" rel="tag">git</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-操作系统之死锁避免算法-银行家算法实现" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/09/22/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B%E6%AD%BB%E9%94%81%E9%81%BF%E5%85%8D%E7%AE%97%E6%B3%95-%E9%93%B6%E8%A1%8C%E5%AE%B6%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/" class="article-date">
  <time class="dt-published" datetime="2019-09-22T14:53:12.000Z" itemprop="datePublished">2019-09-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/09/22/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B%E6%AD%BB%E9%94%81%E9%81%BF%E5%85%8D%E7%AE%97%E6%B3%95-%E9%93%B6%E8%A1%8C%E5%AE%B6%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/">操作系统之死锁避免算法-银行家算法实现</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="0、写在前面"><a href="#0、写在前面" class="headerlink" title="0、写在前面"></a>0、写在前面</h2><p>银行家算法（Banker’s Algorithm）是一个避免死锁（Deadlock）的著名算法，是由艾兹格·迪杰斯特拉在1965年为T.H.E系统设计的一种避免死锁产生的算法。它以银行借贷系统的分配策略为基础，判断并保证系统的安全运行。</p>
<p>你没看错，就是那个Dijkstra</p>
<p>还记得数据结构中的最短路径Dijkstra算法吗？没错就是你想的那样</p>
<p>操作系统进程同步问题中的信号量和PV原语也是Dijkstra提出的，顺便还提出并解决了”哲学家问题”</p>
<p>并且是第一个Algol 60编译器的设计者和实现者。</p>
<p><img src="/images/5bafa40f4bfbfbed0665455c78f0f736afc31fd0.jpg" alt="img"></p>
<p>头发还是比较多的。</p>
<h2 id="1、问题描述"><a href="#1、问题描述" class="headerlink" title="1、问题描述"></a>1、问题描述</h2><p>在银行中，客户申请贷款的数量是有限的，每个客户在第一次申请贷款时要声明完成该项目所需的最大资金量，在满足所有贷款要求时，客户应及时归还。银行家在客户申请的贷款数量不超过自己拥有的最大值时，都应尽量满足客户的需要。在这样的描述中，银行家就好比操作系统，资金就是资源，客户就相当于要申请资源的进程。</p>
<p>简单的说就是：系统资源有限，要使用银行家算法来进行资源分配要求：既要满足当前正在运行的若干进程运行又要避免因为资源分配问题导致的死锁问题。</p>
<h3 id="说明一些下用到的数据结构"><a href="#说明一些下用到的数据结构" class="headerlink" title="说明一些下用到的数据结构"></a>说明一些下用到的数据结构</h3><p><strong>1）可利用资源向量Available</strong></p>
<p>是个含有m个元素的数组，其中的每一个元素代表一类可利用的资源数目。如果Available[j]=K，则表示系统中现有Rj类资源K个。</p>
<p><strong>2）最大需求矩阵Max</strong></p>
<p>这是一个n×m的矩阵，它定义了系统中n个进程中的每一个进程对m类资源的最大需求。如果Max[i,j]=K，则表示进程i需要Rj类资源的最大数目为K。</p>
<p><strong>3）分配矩阵Allocation</strong></p>
<p>这也是一个n×m的矩阵，它定义了系统中每一类资源当前已分配给每一进程的资源数。如果Allocation[i,j]=K，则表示进程i当前已分得Rj类资源的 数目为K。</p>
<p><strong>4）需求矩阵Need</strong></p>
<p>这也是一个n×m的矩阵，用以表示每一个进程尚需的各类资源数。如果Need[i,j]=K，则表示进程i还需要Rj类资源K个，方能完成其任务。</p>
<p>Need[i,j]=Max[i,j]-Allocation[i,j]</p>
<p>看一道2018年408题目：</p>
<blockquote>
<p>假设系统中有4个同类资源，进程P1和P2需要的资源数分别为4，3和1，P1，P2和P3已申请到的资源数分别为2，1和0，则执行安全检测算法的结果是（）</p>
<p>A:不存在安全序列，系统处于不安全态</p>
<p>B:存在多个安全序列，系统处于安全状态</p>
<p>C:存在唯一安全序列P3，P1，P2，系统处于安全状态</p>
<p>D:存在唯一安全序列P3，P2，P1，系统处于安全状态</p>
</blockquote>
<p>这道题还是比较简单的，还是那句老话，学习要由浅入深，循序渐进嘛。</p>
<p>首先阅读题目画出下面这张表格</p>
<p><img src="/images/20190922231755.png" alt="img"></p>
<p>问号部分是我们要计算的</p>
<p>对于Available来说还是比较好算出的直接用系统资源总数（本道题就一种资源）减去当前已经分配出去的资源数即可即4-（2+1+0）= 1</p>
<p>对于Need列来说计算也是灰常简单的直接用每个进程对应的Max列减去Allocation列即可</p>
<p>P1进程Need = 4-2=2</p>
<p>P2进程Need = 3-1=2</p>
<p>P3进程Need = 1-0=1</p>
<p><img src="/images/20190922232304.png" alt="img"></p>
<p>现在手动模拟银行家算法进行安全检查：</p>
<p>由于当前可用资源为1，所以扫描Need列时发现只有P3进程需求满足小于等于可用条件，所以只能尝试将资源分配给P3进程；当资源分配给P3进程后P3进程运行完成，此时可用资源数为1+0 = 1,还是1，而P2和P1都需要至少2个资源所以不存在安全序列使得所有进程都能完成。</p>
<p>所以这道题正确答案是：A</p>
<h2 id="2、编码实现"><a href="#2、编码实现" class="headerlink" title="2、编码实现"></a>2、编码实现</h2><p>银行家算法.cpp</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Dijkstra 于1965年提出能够避免死锁的调度方法，称为银行家算法</span></span><br><span class="line"><span class="comment">// @Author: Michael Jiang sencom1997@outlook.com</span></span><br><span class="line"><span class="comment">// 2019年9月22日 20点26分</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 资源种类数</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">size_t</span> RESOURCE_KIND_NUMS =<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 进程数</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">size_t</span> PROCESS_NUMS = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//进程完成标志数组</span></span><br><span class="line"><span class="keyword">bool</span> finshed[PROCESS_NUMS] = &#123;<span class="literal">false</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// a,b矩阵相减结果存放在c中</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">matrixSub</span><span class="params">( <span class="keyword">int</span> (*a)[RESOURCE_KIND_NUMS],\</span></span></span><br><span class="line"><span class="function"><span class="params">                <span class="keyword">int</span> (*b)[RESOURCE_KIND_NUMS],\</span></span></span><br><span class="line"><span class="function"><span class="params">                <span class="keyword">int</span> (*c)[RESOURCE_KIND_NUMS])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; PROCESS_NUMS; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> j = <span class="number">0</span>; j &lt; RESOURCE_KIND_NUMS; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            c[i][j] = a[i][j] - b[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印矩阵</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printMatrix</span><span class="params">(<span class="keyword">int</span> (*a)[RESOURCE_KIND_NUMS])</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; PROCESS_NUMS; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> j = <span class="number">0</span>; j &lt; RESOURCE_KIND_NUMS; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在分配矩阵中求出某个资源的已分配数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getAllocationCount</span><span class="params">(<span class="keyword">int</span> (*allocation)[RESOURCE_KIND_NUMS],<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; PROCESS_NUMS; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        count += allocation[i][index];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 求出各资源的当前可用量</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getAvailable</span><span class="params">(<span class="keyword">int</span> (*available),\</span></span></span><br><span class="line"><span class="function"><span class="params">                <span class="keyword">int</span> (*resource),\</span></span></span><br><span class="line"><span class="function"><span class="params">                <span class="keyword">int</span> (*allocation)[RESOURCE_KIND_NUMS])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; RESOURCE_KIND_NUMS; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        available[i] = resource[i] - getAllocationCount(allocation,i);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">safeSub</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; RESOURCE_KIND_NUMS; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i] &lt; b[i] )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">safeAdd</span><span class="params">(<span class="keyword">int</span> (*allocation)[RESOURCE_KIND_NUMS],<span class="keyword">int</span> (*available),<span class="keyword">int</span> index)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; RESOURCE_KIND_NUMS; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        available[i] += allocation[index][i];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">isSafe</span><span class="params">(<span class="keyword">int</span> (*available),\</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">int</span> (*need)[RESOURCE_KIND_NUMS],\</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">int</span> (*max)[RESOURCE_KIND_NUMS],\</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">int</span> (*allocation)[RESOURCE_KIND_NUMS])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; PROCESS_NUMS; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (safeSub(available,need[i]) &amp;&amp; !finshed[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//如果够分配的话，就将该进程原先分配的全部收回</span></span><br><span class="line">            safeAdd(allocation,available,i);</span><br><span class="line">            <span class="comment">//将线程完成标志置true</span></span><br><span class="line">            finshed[i] = <span class="literal">true</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Process-%d ==&gt; &quot;</span>,i);</span><br><span class="line">            isSafe(available,need,max,allocation);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 资源数目</span></span><br><span class="line">    <span class="keyword">int</span> resource[RESOURCE_KIND_NUMS] = &#123;</span><br><span class="line">        <span class="number">3</span>,<span class="number">7</span>,<span class="number">11</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 可利用资源向量</span></span><br><span class="line">    <span class="keyword">int</span> available[RESOURCE_KIND_NUMS];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 最大需求矩阵</span></span><br><span class="line">    <span class="keyword">int</span> max[PROCESS_NUMS][RESOURCE_KIND_NUMS] = &#123;</span><br><span class="line">        &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">4</span>&#125;,</span><br><span class="line">        &#123;<span class="number">1</span>,<span class="number">7</span>,<span class="number">5</span>&#125;,</span><br><span class="line">        &#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>&#125;,</span><br><span class="line">        &#123;<span class="number">0</span>,<span class="number">6</span>,<span class="number">4</span>&#125;,</span><br><span class="line">        &#123;<span class="number">0</span>,<span class="number">6</span>,<span class="number">5</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 分配矩阵</span></span><br><span class="line">    <span class="keyword">int</span> allocation[PROCESS_NUMS][RESOURCE_KIND_NUMS] = &#123;</span><br><span class="line">        &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>&#125;,</span><br><span class="line">        &#123;<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,</span><br><span class="line">        &#123;<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>&#125;,</span><br><span class="line">        &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 需求矩阵</span></span><br><span class="line">    <span class="keyword">int</span> need[PROCESS_NUMS][RESOURCE_KIND_NUMS];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//求出need矩阵</span></span><br><span class="line">    matrixSub(max,allocation,need);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//求出当前可用资源数</span></span><br><span class="line">    getAvailable(available,resource,allocation);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;allocation(分配矩阵):\n&quot;</span>);</span><br><span class="line">    printMatrix(allocation);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;max(最大需求矩阵):\n&quot;</span>);</span><br><span class="line">    printMatrix(max);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;need(需求矩阵):\n&quot;</span>);</span><br><span class="line">    printMatrix(need);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;available(可利用资源向量):\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; RESOURCE_KIND_NUMS; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;available[%d] = %d\n&quot;</span>,i,available[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">    <span class="comment">// 进行安全检查</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;安全序列:\n&quot;</span>);</span><br><span class="line">    isSafe(available,need,max,allocation);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;各进程完成情况:\n&quot;</span>);</span><br><span class="line">    <span class="keyword">bool</span> safe = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; PROCESS_NUMS; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Process-%d : %s\n&quot;</span>,i,finshed[i]?<span class="string">&quot;finshed&quot;</span>:<span class="string">&quot;locked&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(!finshed[i])&#123;</span><br><span class="line">            safe = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;是否安全:\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;isSafe=%s\n&quot;</span>,safe?<span class="string">&quot;true&quot;</span>:<span class="string">&quot;false&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码模拟的是5个进程P0~P4和三种资源0，1，2在给定的状态下看到系统是否处于安全状态。</p>
<p>运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Michael Jiang\Desktop\408数据结构&gt;g++ 银行家算法.cpp &amp;&amp; a.exe</span><br><span class="line">allocation(分配矩阵):</span><br><span class="line">0 0 3</span><br><span class="line">1 0 0</span><br><span class="line">1 3 5</span><br><span class="line">0 0 2</span><br><span class="line">0 0 1</span><br><span class="line"></span><br><span class="line">max(最大需求矩阵):</span><br><span class="line">0 0 4</span><br><span class="line">1 7 5</span><br><span class="line">2 3 5</span><br><span class="line">0 6 4</span><br><span class="line">0 6 5</span><br><span class="line"></span><br><span class="line">need(需求矩阵):</span><br><span class="line">0 0 1</span><br><span class="line">0 7 5</span><br><span class="line">1 0 0</span><br><span class="line">0 6 2</span><br><span class="line">0 6 4</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">available(可利用资源向量):</span><br><span class="line">available[0] &#x3D; 1</span><br><span class="line">available[1] &#x3D; 4</span><br><span class="line">available[2] &#x3D; 0</span><br><span class="line"></span><br><span class="line">安全序列:</span><br><span class="line">Process-2 &#x3D;&#x3D;&gt; Process-0 &#x3D;&#x3D;&gt; Process-1 &#x3D;&#x3D;&gt; Process-3 &#x3D;&#x3D;&gt; Process-4 &#x3D;&#x3D;&gt;</span><br><span class="line"></span><br><span class="line">各进程完成情况:</span><br><span class="line">Process-0 : finshed</span><br><span class="line">Process-1 : finshed</span><br><span class="line">Process-2 : finshed</span><br><span class="line">Process-3 : finshed</span><br><span class="line">Process-4 : finshed</span><br><span class="line"></span><br><span class="line">是否安全:</span><br><span class="line">isSafe&#x3D;true</span><br></pre></td></tr></table></figure>

<hr>
<p>下面对main()方法做一些简单的修改：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 资源数目</span></span><br><span class="line"><span class="keyword">int</span> resource[RESOURCE_KIND_NUMS] = &#123;</span><br><span class="line">    <span class="number">3</span>,<span class="number">7</span>,<span class="number">11</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>将上面的代码改为</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 资源数目c</span></span><br><span class="line"><span class="keyword">int</span> resource[RESOURCE_KIND_NUMS] = &#123;</span><br><span class="line">    <span class="number">3</span>,<span class="number">4</span>,<span class="number">12</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>再次执行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Michael Jiang\Desktop\408数据结构&gt;g++ 银行家算法.cpp &amp;&amp; a.exe</span><br><span class="line">allocation(分配矩阵):</span><br><span class="line">0 0 3</span><br><span class="line">1 0 0</span><br><span class="line">1 3 5</span><br><span class="line">0 0 2</span><br><span class="line">0 0 1</span><br><span class="line"></span><br><span class="line">max(最大需求矩阵):</span><br><span class="line">0 0 4</span><br><span class="line">1 7 5</span><br><span class="line">2 3 5</span><br><span class="line">0 6 4</span><br><span class="line">0 6 5</span><br><span class="line"></span><br><span class="line">need(需求矩阵):</span><br><span class="line">0 0 1</span><br><span class="line">0 7 5</span><br><span class="line">1 0 0</span><br><span class="line">0 6 2</span><br><span class="line">0 6 4</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">available(可利用资源向量):</span><br><span class="line">available[0] &#x3D; 1</span><br><span class="line">available[1] &#x3D; 1</span><br><span class="line">available[2] &#x3D; 1</span><br><span class="line"></span><br><span class="line">安全序列:</span><br><span class="line">Process-0 &#x3D;&#x3D;&gt; Process-2 &#x3D;&#x3D;&gt;</span><br><span class="line"></span><br><span class="line">各进程完成情况:</span><br><span class="line">Process-0 : finshed</span><br><span class="line">Process-1 : locked</span><br><span class="line">Process-2 : finshed</span><br><span class="line">Process-3 : locked</span><br><span class="line">Process-4 : locked</span><br><span class="line"></span><br><span class="line">是否安全:</span><br><span class="line">isSafe&#x3D;false</span><br></pre></td></tr></table></figure>

<p>这就不安全了，不相信？要不你手算一下？</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/09/22/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B%E6%AD%BB%E9%94%81%E9%81%BF%E5%85%8D%E7%AE%97%E6%B3%95-%E9%93%B6%E8%A1%8C%E5%AE%B6%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/" data-id="cknhkthez0000zktv4nrr43eq" data-title="操作系统之死锁避免算法-银行家算法实现" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algo/" rel="tag">algo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Git基本操作之从GitHub下载和上传项目" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/09/15/Git%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E4%B9%8B%E4%BB%8EGitHub%E4%B8%8B%E8%BD%BD%E5%92%8C%E4%B8%8A%E4%BC%A0%E9%A1%B9%E7%9B%AE/" class="article-date">
  <time class="dt-published" datetime="2019-09-15T15:26:15.000Z" itemprop="datePublished">2019-09-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/09/15/Git%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E4%B9%8B%E4%BB%8EGitHub%E4%B8%8B%E8%BD%BD%E5%92%8C%E4%B8%8A%E4%BC%A0%E9%A1%B9%E7%9B%AE/">Git基本操作之从GitHub下载和上传项目</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>看了一下上一篇是八月二十七号写的，今天已经九月十五号了。期间本来应该有一个小企鹅输入法的，但是由于没能调试完成所以又被延期了，至于什么时候能搞好，我自己也不知道。</p>
<p>那么这半个月都干了啥？</p>
<p>1.这学期开发环境基本钦定为JetBrains全家桶（Eclipse已经被无情的抛弃了）</p>
<p>2.开启了新的课程表（全部排满）</p>
<p>3.开始leetcode刷题（还是嫌自己头发多）</p>
<p>4.努力学习，红专迸进！</p>
<hr>
<p>正文：</p>
<p>首先看一下我的Git版本哈</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\Michael Jiang&gt; git --version</span><br><span class="line">git version 2.21.0.windows.1</span><br></pre></td></tr></table></figure>

<p>我这个git装的比较早，以前只知道用git clone 哈哈（本以为git就是方便窃别人代码的）</p>
<p>真是对不起Linus老人家，搞的这个东西这么excting，我现在才来学习。</p>
<p>对待技术只要我们愿意付出，它都会给与我们最大的帮助。</p>
<h2 id="1-在GitHub创建一个空项目"><a href="#1-在GitHub创建一个空项目" class="headerlink" title="1.在GitHub创建一个空项目"></a>1.在GitHub创建一个空项目</h2><p>写个名字就可以了</p>
<h2 id="2-在本地初始化一个Git"><a href="#2-在本地初始化一个Git" class="headerlink" title="2.在本地初始化一个Git"></a>2.在本地初始化一个Git</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Michael Jiang@DESKTOP-JUOEVVQ MINGW64 ~&#x2F;Desktop&#x2F;HelloProject&#x2F;GitTest</span><br><span class="line">$ git init</span><br><span class="line">Initialized empty Git repository in C:&#x2F;Users&#x2F;Michael Jiang&#x2F;Desktop&#x2F;HelloProject&#x2F;GitTest&#x2F;.git&#x2F;</span><br></pre></td></tr></table></figure>

<h2 id="3-创建SSH密钥对"><a href="#3-创建SSH密钥对" class="headerlink" title="3.创建SSH密钥对"></a>3.创建SSH密钥对</h2><p><img src="/images/20190915151607.png" alt="img"></p>
<h2 id="4-将pub-key配置到Github中"><a href="#4-将pub-key配置到Github中" class="headerlink" title="4.将pub key配置到Github中"></a>4.将pub key配置到Github中</h2><p>在github设置中，有相关ssh的配置。</p>
<p>配置完成后结果如下：</p>
<p><img src="/images/20190915152015.png" alt="img"></p>
<h2 id="5-本地git连接GitHub"><a href="#5-本地git连接GitHub" class="headerlink" title="5.本地git连接GitHub"></a>5.本地git连接GitHub</h2><p>在git命令行输入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure>

<p><img src="/images/20190915152416.png" alt="img"></p>
<p>登陆到github上查看刚刚输入的SSH key，现在图标的颜色变为绿色，说明密钥配置有效；现在可以在git命令行上进行git操作了。</p>
<h2 id="6-上传本地项目到仓库"><a href="#6-上传本地项目到仓库" class="headerlink" title="6.上传本地项目到仓库"></a>6.上传本地项目到仓库</h2><p>（1）上传到远程仓库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git remote add origin git@github.com:yourName&#x2F;yourRepo.gitwison</span><br></pre></td></tr></table></figure>

<p>yourName是你的用户名，yourRepo.gitwison是你要上传项目的仓库。</p>
<p>（2）添加你要上传的文件，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add . </span><br></pre></td></tr></table></figure>

<p>.代表上传目录下所有文件，可以在git add后面加上你要添加的文件，比如git add test.md</p>
<p>(3)提交项目，输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -a -m &quot;wison&quot; </span><br></pre></td></tr></table></figure>

<p><code>wison</code>是标记谁上传。再输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin master</span><br></pre></td></tr></table></figure>

<p>大功告成!</p>
<p><img src="/images/20190915154038.png" alt="img"></p>
<p>在GitHub查看项目</p>
<p><img src="/images/20190915154127.png" alt="img"></p>
<p>OK!</p>
<p>通过上面的一顿操作，最后去设置里面看一下SSH小钥匙终于绿了，&lt; _ &gt;</p>
<p><img src="/images/20190915155125.png" alt="img"></p>
<hr>
<p>至此push基本操作结束，下面简单介绍一下pull操作吧！</p>
<p><img src="/images/20190915162127.png" alt="img"></p>
<p>具体流程就是把我的GitHub上的GitTest项目拉到本地，然后做了一些改动（添加了一个新文件），最后将改动后的项目再次推到Github上。</p>
<p>此时再去Github查看：</p>
<p><img src="/images/20190915162422.png" alt="img"></p>
<p>操作成功！</p>
<p>最后：配置SSH密钥后免去了每次输入账号密码的麻烦，采用Git这种极为先进的版本控制系统来管理我们的项目是非常有必要的；用了就回不去了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/09/15/Git%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E4%B9%8B%E4%BB%8EGitHub%E4%B8%8B%E8%BD%BD%E5%92%8C%E4%B8%8A%E4%BC%A0%E9%A1%B9%E7%9B%AE/" data-id="cknhlyqje0000xgtvhpop45gq" data-title="Git基本操作之从GitHub下载和上传项目" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/" rel="tag">git</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Foreach-循环中进行元素的remove-add操作？" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/08/27/Foreach-%E5%BE%AA%E7%8E%AF%E4%B8%AD%E8%BF%9B%E8%A1%8C%E5%85%83%E7%B4%A0%E7%9A%84remove-add%E6%93%8D%E4%BD%9C%EF%BC%9F/" class="article-date">
  <time class="dt-published" datetime="2019-08-27T15:35:46.000Z" itemprop="datePublished">2019-08-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/08/27/Foreach-%E5%BE%AA%E7%8E%AF%E4%B8%AD%E8%BF%9B%E8%A1%8C%E5%85%83%E7%B4%A0%E7%9A%84remove-add%E6%93%8D%E4%BD%9C%EF%BC%9F/">Foreach 循环中进行元素的remove/add操作？</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>今天看<strong>java开发手册（华山版）</strong>时发现一个巨坑！！！</p>
<p>话说阿里搞的这个东西真是<strong>excited</strong>！</p>
<p>手册上是这样描述的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">11.</span> 【强制】不要在foreach循环里进行元素的remove/add操作。remove元素请使用Iterator方式，如果并发操作，需要对Iterator对象加锁。</span><br><span class="line">正例：</span><br><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">list.add(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">list.add(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">Iterator&lt;String&gt; iterator = list.iterator();</span><br><span class="line"><span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">    String item = iterator.next();</span><br><span class="line">    <span class="keyword">if</span> (删除元素的条件) &#123;</span><br><span class="line">        iterator.remove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">反例：</span><br><span class="line"><span class="keyword">for</span> (String item : list) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;1&quot;</span>.equals(item)) &#123;</span><br><span class="line">        list.remove(item);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">说明：以上代码的执行结果肯定会出乎大家的意料，那么试一下把“<span class="number">1</span>”换成“<span class="number">2</span>”，会是同样的结果吗？</span><br></pre></td></tr></table></figure>

<p>上面代码删除List中的“1”时候是没有问题的，但是当我测试他这个说明时</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">说明：以上代码的执行结果肯定会出乎大家的意料，那么试一下把“1”换成“2”，会是同样的结果吗？</span><br></pre></td></tr></table></figure>

<p>正例的代码就是正例，没有任何问题；反例就不行了直接报错：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; java.util.ConcurrentModificationException</span><br><span class="line">	at java.util.ArrayList$Itr.checkForComodification(Unknown Source)</span><br><span class="line">	at java.util.ArrayList$Itr.next(Unknown Source)</span><br><span class="line">	at top.sencom.redis.Demo.RedisDemo.main(RedisDemo.java:22)</span><br></pre></td></tr></table></figure>

<p>那就来仔细研究一下到底怎么回事！</p>
<p>问题首先出现在<code>ava.util.ArrayList$Itr.next</code></p>
<p>哎，对于反例用的可是foreach循环啊，咋报错中有迭代器字样的东西（Itr），莫非这个foreach循环就是用迭代器实现的？？？！！！</p>
<p>通过询问度娘得到如下结果：<a target="_blank" rel="noopener" href="https://blog.csdn.net/a596620989/article/details/6930479">https://blog.csdn.net/a596620989/article/details/6930479</a></p>
<p>通过这篇文章可以得出<strong>：foreach语法最终被编译器转为了对Iterator.next()的调用</strong></p>
<p>这样的话就是来回翻一翻，瞅一瞅</p>
<p><strong>java.util.ArrayList</strong></p>
<p><strong>java.util.AbstractList</strong></p>
<p>于是乎就找到了这个地方：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Itr</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * Index of element to be returned by subsequent call to next.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">int</span> cursor = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * Index of element returned by most recent call to next or</span></span><br><span class="line"><span class="comment">         * previous.  Reset to -1 if this element is deleted by a call</span></span><br><span class="line"><span class="comment">         * to remove.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">int</span> lastRet = -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * The modCount value that the iterator believes that the backing</span></span><br><span class="line"><span class="comment">         * List should have.  If this expectation is violated, the iterator</span></span><br><span class="line"><span class="comment">         * has detected concurrent modification.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">int</span> expectedModCount = modCount;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> cursor != size();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            checkForComodification();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> i = cursor;</span><br><span class="line">                E next = get(i);</span><br><span class="line">                lastRet = i;</span><br><span class="line">                cursor = i + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">return</span> next;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException e) &#123;</span><br><span class="line">                checkForComodification();</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (lastRet &lt; <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();</span><br><span class="line">            checkForComodification();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                AbstractList.<span class="keyword">this</span>.remove(lastRet);</span><br><span class="line">                <span class="keyword">if</span> (lastRet &lt; cursor)</span><br><span class="line">                    cursor--;</span><br><span class="line">                lastRet = -<span class="number">1</span>;</span><br><span class="line">                expectedModCount = modCount;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IndexOutOfBoundsException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">checkForComodification</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (modCount != expectedModCount)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>当我们用foreach时迭代器初始时<code> int expectedModCount = modCount;</code></p>
<p>这里的modCount该值表示对List的修改次数，它是在父类<strong>java.util.AbstractList</strong>中定义的，查看ArrayList的add()和remove()方法就可以发现，每次调用add()方法或者remove()方法就会对modCount进行加1操作。</p>
<p>此时你在foreach循环里面执行<code>list.remove(item);</code></p>
<p>元素是移除了，但是<strong>ArrayList 类中的remove（）方法会使</strong>modeCount++；而foreach循环的迭代器中的<code>expectedModCount </code>并没有++，这就会使的在迭代器调用next（）方法时调用checkForComodification()方法中发现<code>modCount != expectedModCount</code>从而<code> throw new ConcurrentModificationException();</code></p>
<p><strong>好，既然知道了错误出在什么地方；那么就想办法避免这个问题吧。</strong></p>
<p><strong>那就是在使用迭代器时移除元素需要使用迭代器的移除方法而非List的移除方法！</strong></p>
<p>就像正例中那样即可！</p>
<p>其实在JDK中也有类似表述：</p>
<blockquote>
<p>The iterators returned by this class’s <a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html#iterator--"><code>iterator</code></a> and <a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html#listIterator-int-"><code>listIterator</code></a> methods are <em>fail-fast</em>: if the list is structurally modified at any time after the iterator is created, in any way except through the iterator’s own <a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/util/ListIterator.html#remove--"><code>remove</code></a> or <a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/util/ListIterator.html#add-E-"><code>add</code></a> methods, the iterator will throw a<a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/util/ConcurrentModificationException.html"><code>ConcurrentModificationException</code></a>. Thus, in the face of concurrent modification, the iterator fails  quickly and cleanly, rather than risking arbitrary, non-deterministic  behavior at an undetermined time in the future.</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html%E3%80%81">https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html、</a></p>
<p><strong>在回头来看问什么移除“1”可以？</strong></p>
<p>这还得在分析一下：</p>
<p>“1”这个元素在list的倒数第二个当它被list的remove（）方法移除之后</p>
<p>list的size（）会减少；而cursor表示当前位置。</p>
<p>迭代器完成一次循环执行<code> public boolean hasNext() &#123;            return cursor != size();        &#125;</code></p>
<p>时就会返回fase从而终止循环：也就是说当你往列表中添加两个元素都为“1”时你会发现foreach循环只能删除一个。也就是第一个“1”.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/08/27/Foreach-%E5%BE%AA%E7%8E%AF%E4%B8%AD%E8%BF%9B%E8%A1%8C%E5%85%83%E7%B4%A0%E7%9A%84remove-add%E6%93%8D%E4%BD%9C%EF%BC%9F/" data-id="cknhmaj7700001ctvep673uej" data-title="Foreach 循环中进行元素的remove/add操作？" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; 上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/adb/" rel="tag">adb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algo/" rel="tag">algo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/assembly/" rel="tag">assembly</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/" rel="tag">c</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/debian/" rel="tag">debian</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/error/" rel="tag">error</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/golang/" rel="tag">golang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/junit/" rel="tag">junit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mybatis/" rel="tag">mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pip/" rel="tag">pip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/project/" rel="tag">project</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pyhthon/" rel="tag">pyhthon</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/raspberrypi/" rel="tag">raspberrypi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/" rel="tag">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rsa/" rel="tag">rsa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/" rel="tag">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/adb/" style="font-size: 10px;">adb</a> <a href="/tags/algo/" style="font-size: 14px;">algo</a> <a href="/tags/android/" style="font-size: 16px;">android</a> <a href="/tags/assembly/" style="font-size: 10px;">assembly</a> <a href="/tags/c/" style="font-size: 18px;">c</a> <a href="/tags/debian/" style="font-size: 10px;">debian</a> <a href="/tags/error/" style="font-size: 14px;">error</a> <a href="/tags/git/" style="font-size: 12px;">git</a> <a href="/tags/golang/" style="font-size: 10px;">golang</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/junit/" style="font-size: 10px;">junit</a> <a href="/tags/linux/" style="font-size: 16px;">linux</a> <a href="/tags/mybatis/" style="font-size: 12px;">mybatis</a> <a href="/tags/pip/" style="font-size: 10px;">pip</a> <a href="/tags/project/" style="font-size: 10px;">project</a> <a href="/tags/pyhthon/" style="font-size: 10px;">pyhthon</a> <a href="/tags/raspberrypi/" style="font-size: 10px;">raspberrypi</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/rsa/" style="font-size: 10px;">rsa</a> <a href="/tags/spring/" style="font-size: 10px;">spring</a> <a href="/tags/windows/" style="font-size: 12px;">windows</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/04/14/yum-update-%E6%8A%A5%E9%94%99/">yum update 报错</a>
          </li>
        
          <li>
            <a href="/2021/02/08/JUNIT-CLASS-NOT-FOUND-MYTEST/">JUNIT : CLASS NOT FOUND: &#39;MYTEST&#39;</a>
          </li>
        
          <li>
            <a href="/2021/02/05/MYBATIS-2-%E6%95%B4%E5%90%88SPRING5/">MYBATIS-2-整合SPRING5</a>
          </li>
        
          <li>
            <a href="/2021/02/01/MYBATIS-1-%E7%AC%AC%E4%B8%80%E4%B8%AA%E4%BE%8B%E5%AD%90/">MYBATIS-1-第一个例子</a>
          </li>
        
          <li>
            <a href="/2021/01/20/%E8%A1%A8%E5%8D%95%E5%85%B3%E9%94%AE%E4%BF%A1%E6%81%AF%E7%9A%84%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E4%BC%A0%E8%BE%93/">表单关键信息的非对称加密传输</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 BH6AOL<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>