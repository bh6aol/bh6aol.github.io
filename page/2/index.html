<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>BH6AOL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="BH6AOL">
<meta property="og:url" content="https://bh6aol.top/page/2/index.html">
<meta property="og:site_name" content="BH6AOL">
<meta property="og:locale">
<meta property="article:author" content="BH6AOL">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="BH6AOL" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">BH6AOL</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">CQ CQ CQ, this is BH6AOL, calling CQ and standing by.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Suche"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://bh6aol.top"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-自定义ListView适配器" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/04/18/%E8%87%AA%E5%AE%9A%E4%B9%89ListView%E9%80%82%E9%85%8D%E5%99%A8/" class="article-date">
  <time class="dt-published" datetime="2020-04-18T11:51:14.000Z" itemprop="datePublished">2020-04-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/04/18/%E8%87%AA%E5%AE%9A%E4%B9%89ListView%E9%80%82%E9%85%8D%E5%99%A8/">自定义ListView适配器</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>最近想写一个音乐播放器作为安卓课程验收作业；于是拿起早些时候写的一个jayPlayer准备魔改一下，这个App使用的音乐资源来自Github上<a target="_blank" rel="noopener" href="https://github.com/jsososo/MiguMusicApi%E7%94%A8%E7%9A%84%E6%98%AF%E5%92%AA%E5%92%95%E9%9F%B3%E4%B9%90%E7%9A%84API%EF%BC%8C%E6%89%80%E4%BB%A5%E5%8F%AF%E4%BB%A5%E6%92%AD%E6%94%BE%E6%9D%B0%E4%BC%A6%E7%9A%84%E6%AD%8C%E3%80%82">https://github.com/jsososo/MiguMusicApi用的是咪咕音乐的API，所以可以播放杰伦的歌。</a></p>
<p>书归正传，先看效果图</p>
<p><img src="/images/20200418221640.png" alt="img"></p>
<p>如图所示，每个搜索结果为一行大字和一行小字。其中大字是歌曲名；小字是歌手和专辑名。这种简单的两行显示其实安卓自身就有</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android.R.layout.simple_list_item_2</span><br></pre></td></tr></table></figure>

<p>这个布局就是显示两个的。但是如果还要显示一张图片就不行了，由此引入本次主题，既然你能造这个我也能模仿造一个出来。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;ScrollView</span><br><span class="line">            android:id=&quot;@+id/scrollView&quot;</span><br><span class="line">            app:layout_constraintTop_toBottomOf=&quot;@+id/grid&quot;</span><br><span class="line">            app:layout_constraintLeft_toLeftOf=&quot;parent&quot;</span><br><span class="line">            app:layout_constraintBottom_toBottomOf=&quot;parent&quot;</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;match_parent&quot;</span><br><span class="line">            android:fillViewport=&quot;true&quot;</span><br><span class="line">            android:scrollbars=&quot;vertical&quot;&gt;</span><br><span class="line">                &lt;ListView</span><br><span class="line">                    android:id=&quot;@+id/listview&quot;</span><br><span class="line">                    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">                    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">                    /&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">ScrollView</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这是下方搜索结果的布局文件，其中我们定义了一个listview.</p>
<p>下面是重写适配器部分，先看一下用到的ShowItem类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> top.sencom.jayplayer.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShowItem</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String albumName;</span><br><span class="line">    <span class="keyword">private</span> String artistName;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ShowItem</span><span class="params">(String name, String albumName, String artistName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.albumName = albumName;</span><br><span class="line">        <span class="keyword">this</span>.artistName = artistName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAlbumName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> albumName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAlbumName</span><span class="params">(String albumName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.albumName = albumName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getArtistName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> artistName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setArtistName</span><span class="params">(String artistName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.artistName = artistName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  name + <span class="string">&#x27;\n&#x27;</span> + albumName + <span class="string">&#x27;/&#x27;</span> + artistName ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> top.sencom.jayplayer.adapter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"><span class="keyword">import</span> android.widget.BaseAdapter;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> top.sencom.jayplayer.R;</span><br><span class="line"><span class="keyword">import</span> top.sencom.jayplayer.model.ShowItem;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchResultAdapter</span> <span class="keyword">extends</span> <span class="title">BaseAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;ShowItem&gt; data;</span><br><span class="line">    <span class="keyword">private</span> LayoutInflater layoutInflater;</span><br><span class="line">    <span class="keyword">private</span> Context context;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SearchResultAdapter</span><span class="params">(Context context, List&lt;ShowItem&gt; data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.context = context;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">        <span class="keyword">this</span>.layoutInflater = LayoutInflater.from(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Info</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> TextView fristLine;</span><br><span class="line">        <span class="keyword">public</span> TextView secondLine;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data.get(position);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getItemId</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> position;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">getView</span><span class="params">(<span class="keyword">int</span> position, View convertView, ViewGroup parent)</span> </span>&#123;</span><br><span class="line">        Info info = <span class="keyword">new</span> Info();</span><br><span class="line">        convertView = layoutInflater.inflate(R.layout.show_each_item, <span class="keyword">null</span>);</span><br><span class="line">        info.fristLine = convertView.findViewById(R.id.first_line);</span><br><span class="line">        info.secondLine = convertView.findViewById(R.id.second_line);</span><br><span class="line"></span><br><span class="line">        info.fristLine.setText(data.get(position).getName());</span><br><span class="line">        info.secondLine.setText(data.get(position).getArtistName()+<span class="string">&quot;-&quot;</span>+data.get(position).getAlbumName());</span><br><span class="line">        <span class="keyword">return</span> convertView;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面自定义适配器核心代码就是getView方法的重写，大概过程就是从R.layout.show_each_item布局文件中加载View，然后为其中的控件赋值，最后返回这个自定义View。</p>
<p>下面是R.layout.show_each_item布局文件</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">&lt;LinearLayout</span><br><span class="line">    android:id=<span class="string">&quot;@+id/show_each_item&quot;</span></span><br><span class="line">    xmlns:android=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">    android:layout_height=<span class="string">&quot;match_parent&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;GridLayout</span><br><span class="line">        android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">        android:layout_height=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">        android:orientation=<span class="string">&quot;vertical&quot;</span></span><br><span class="line">        android:rowCount=<span class="string">&quot;2&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_marginLeft=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">            android:id=<span class="string">&quot;@+id/first_line&quot;</span></span><br><span class="line">            android:layout_width=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">            android:textSize=<span class="string">&quot;23dp&quot;</span></span><br><span class="line">            android:text=<span class="string">&quot;SongName&quot;</span></span><br><span class="line">            android:textColor=<span class="string">&quot;#444&quot;</span></span><br><span class="line">            /&gt;</span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_marginLeft=<span class="string">&quot;10dp&quot;</span></span><br><span class="line">            android:id=<span class="string">&quot;@+id/second_line&quot;</span></span><br><span class="line">            android:text=<span class="string">&quot;Arits-Album&quot;</span></span><br><span class="line">            android:layout_width=<span class="string">&quot;match_parent&quot;</span>/&gt;</span><br><span class="line">    &lt;/GridLayout&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure>

<p>最后我们在Activity中编写如下代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">listView = findViewById(R.id.listview);</span><br><span class="line">List&lt;ShowItem&gt; showItem = <span class="keyword">new</span> ArrayList&lt;ShowItem&gt;();</span><br><span class="line"><span class="comment">// 赋值showItem</span></span><br><span class="line">SearchResultAdapter searchResultAdapter = <span class="keyword">new</span> SearchResultAdapter(MainActivity.<span class="keyword">this</span>,showItem);</span><br><span class="line">listView.setAdapter(searchResultAdapter);</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2020/04/18/%E8%87%AA%E5%AE%9A%E4%B9%89ListView%E9%80%82%E9%85%8D%E5%99%A8/" data-id="cknhir5dn000o1wtv8ly55eep" data-title="自定义ListView适配器" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/" rel="tag">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Android-GridLayout-自適應" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/04/11/Android-GridLayout-%E8%87%AA%E9%81%A9%E6%87%89/" class="article-date">
  <time class="dt-published" datetime="2020-04-11T13:12:53.000Z" itemprop="datePublished">2020-04-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/04/11/Android-GridLayout-%E8%87%AA%E9%81%A9%E6%87%89/">Android GridLayout 自適應</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>最近趁著學習安卓開發，順便將去年暑假就想寫的Loan項目快速構建一下。想寫個菜單界面。決定用網格佈局試一試，但是網友普遍對網格佈局不看好。可能是因爲早期的網格佈局不支持權重的原因吧？總之今天就記錄一下我的踩坑過程。</p>
<p>首先看一下xml佈局文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MenuActivity&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;horizontal&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;#EEEEEE&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;GridLayout</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        android:orientation=&quot;horizontal&quot;</span><br><span class="line">        android:columnCount=&quot;3&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">            android:id=&quot;@+id/contract_btu&quot;</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_columnWeight=&quot;1&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginRight=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginTop=&quot;20dp&quot;</span><br><span class="line">            android:background=&quot;@drawable/selector_contract&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">            android:id=&quot;@+id/invoice_btu&quot;</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_columnWeight=&quot;1&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginRight=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginTop=&quot;20dp&quot;</span><br><span class="line">            android:background=&quot;@drawable/selector_invoice&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">            android:id=&quot;@+id/record_btu&quot;</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_columnWeight=&quot;1&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginRight=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginTop=&quot;20dp&quot;</span><br><span class="line">            android:background=&quot;@drawable/selector_record&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_columnWeight=&quot;1&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginRight=&quot;10dp&quot;</span><br><span class="line">            android:gravity=&quot;center&quot;</span><br><span class="line">            android:text=&quot;我的合同&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_columnWeight=&quot;1&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginRight=&quot;10dp&quot;</span><br><span class="line">            android:gravity=&quot;center&quot;</span><br><span class="line">            android:text=&quot;借據詳情&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_columnWeight=&quot;1&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginRight=&quot;10dp&quot;</span><br><span class="line">            android:gravity=&quot;center&quot;</span><br><span class="line">            android:text=&quot;還款記錄&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">            android:id=&quot;@+id/planning_btu&quot;</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_columnWeight=&quot;1&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginRight=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginTop=&quot;20dp&quot;</span><br><span class="line">            android:background=&quot;@drawable/selector_planning&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">            android:id=&quot;@+id/software_btu&quot;</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_columnWeight=&quot;1&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginRight=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginTop=&quot;20dp&quot;</span><br><span class="line">            android:background=&quot;@drawable/selector_software&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Button</span><br><span class="line">            android:id=&quot;@+id/more_btu&quot;</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_columnWeight=&quot;1&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginRight=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginTop=&quot;20dp&quot;</span><br><span class="line">            android:background=&quot;@drawable/selector_more&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_columnWeight=&quot;1&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginRight=&quot;10dp&quot;</span><br><span class="line">            android:gravity=&quot;center&quot;</span><br><span class="line">            android:text=&quot;還款計劃&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_columnWeight=&quot;1&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginRight=&quot;10dp&quot;</span><br><span class="line">            android:gravity=&quot;center&quot;</span><br><span class="line">            android:text=&quot;軟件信息&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_columnWeight=&quot;1&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;10dp&quot;</span><br><span class="line">            android:layout_marginRight=&quot;10dp&quot;</span><br><span class="line">            android:gravity=&quot;center&quot;</span><br><span class="line">            android:text=&quot;更多工具&quot; /&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">GridLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/images/20200411215223.png" alt="img"></p>
<p>如左圖所示，采用三列的網格，行數沒有固定，其中圖標和圖標下面的文字是等價的，都屬於網格裏面的元素。其中的關鍵點就是將所有網格中的元素列權重全部設置為1，讓它們權重一隻。還有就是設置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:layout_width=&quot;0dp&quot;</span><br></pre></td></tr></table></figure>

<p>此屬性是將控件的佈局寬度設置為0，這樣網格佈局就可以等距自適應的排列内部的控件了。</p>
<p>———分割綫————-</p>
<p>順便提一下，在寫還貸計劃這個子Actively的時候發現Android沒有什麽好用的表格控件，看了幾個github上面的開源項目感覺有點複雜。這是我突然想到了上次折騰小説項目使用的WebView，正好我從銀行下載了計劃的csv文件，於是直接用csv2html將計劃轉成了html的table表格。然後使用Android的assets將其存儲，最終通過webview展示出來，感覺顯示效果還是蠻不錯的。</p>
<p>這次App和服務器之間的數據傳輸我封裝了一個API，數據格式是JSON，還加了一個TOKEN作爲簡單的校驗，不過論安全性還是RSA，AES來的舒服啊。</p>
<p>再説還準備改進的地方就是okhttp的多綫程問題，還有就是從服務器獲取的數據持久化本地sqlite數據庫的問題有待解決。最後一個目前能想到的容易實現的就是檢查升級功能。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2020/04/11/Android-GridLayout-%E8%87%AA%E9%81%A9%E6%87%89/" data-id="cknhir5d300031wtvhhew9foe" data-title="Android GridLayout 自適應" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/" rel="tag">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Golang并发之道-for循环中的goroutine" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/12/16/Golang%E5%B9%B6%E5%8F%91%E4%B9%8B%E9%81%93-for%E5%BE%AA%E7%8E%AF%E4%B8%AD%E7%9A%84goroutine/" class="article-date">
  <time class="dt-published" datetime="2019-12-16T13:35:56.000Z" itemprop="datePublished">2019-12-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/12/16/Golang%E5%B9%B6%E5%8F%91%E4%B9%8B%E9%81%93-for%E5%BE%AA%E7%8E%AF%E4%B8%AD%E7%9A%84goroutine/">Golang并发之道-for循环中的goroutine</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>先看一段代码</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line">	<span class="keyword">for</span> _, sal := <span class="keyword">range</span> []<span class="keyword">string</span>&#123;<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>&#125; &#123;</span><br><span class="line">		wg.Add(<span class="number">1</span>)</span><br><span class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			<span class="keyword">defer</span> wg.Done()</span><br><span class="line">			fmt.Println(sal)</span><br><span class="line">		&#125;()</span><br><span class="line">	&#125;</span><br><span class="line">	wg.Wait()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第一眼看上去程序很简单啊，就是一个for循环，每次循环时起一个goroutine啊？</p>
<p>那么执行结果应该是什么呢，慢着！goroutine不是立即起的哎！难道是乱序打印a,b,c???</p>
<p>run一下便知！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c</span><br><span class="line">c</span><br><span class="line">c</span><br></pre></td></tr></table></figure>

<p>为何都是c？ 难道是巧合？多跑几次试试？</p>
<p>emmmmm，实锤了，就是c！</p>
<p>哈子玩意？</p>
<p>书上这样解释：</p>
<p><strong>goroutine正在运行一个闭包，该闭包使用变量sal时，字符串迭代已经结束。</strong></p>
<p>那goroutine运行时sal从何而来？如果不幸被GC收走怎么办？</p>
<p><strong>这是一个关于如何管理内存的有趣的点。Golang运行时会足够小心的将对变量sal值的引用仍然保留，由内存转移到堆，一便goroutine可以继续访问它。</strong></p>
<p><strong>通常我们计算机上。在任何goroutine开始运行之前，循环就会退出，所以sal会被转移到堆中，即在堆中的sal为字符切片中  最后一个值c，所以通常会看到三次c。编写这个循环的正确方式是将sal的副本传递到闭包中，这样当goroutine运行时，它将从循环的迭代中操作数据。</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line">	<span class="keyword">for</span> _, sal := <span class="keyword">range</span> []<span class="keyword">string</span>&#123;<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>&#125; &#123;</span><br><span class="line">		wg.Add(<span class="number">1</span>)</span><br><span class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(sal <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">			<span class="keyword">defer</span> wg.Done()</span><br><span class="line">			fmt.Println(sal)</span><br><span class="line">		&#125;(sal)</span><br><span class="line">	&#125;</span><br><span class="line">	wg.Wait()</span><br><span class="line">&#125;</span><br><span class="line">c</span><br><span class="line">b</span><br><span class="line">a</span><br></pre></td></tr></table></figure>

<p>这下运行结果就对了（随机打印a，b，c）！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/12/16/Golang%E5%B9%B6%E5%8F%91%E4%B9%8B%E9%81%93-for%E5%BE%AA%E7%8E%AF%E4%B8%AD%E7%9A%84goroutine/" data-id="cknhir5cy00011wtvao463we9" data-title="Golang并发之道-for循环中的goroutine" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/golang/" rel="tag">golang</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Redis-Cluster" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/11/27/Redis-Cluster/" class="article-date">
  <time class="dt-published" datetime="2019-11-27T13:39:56.000Z" itemprop="datePublished">2019-11-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/11/27/Redis-Cluster/">Redis-Cluster</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>暑假期间看了一部分Redis教程，但是没有看完，昨天晚上1.5倍加速从头看完了Redis入门教程。</p>
<p>感觉应该差不多了，今天就来在WSL上模拟一下集群的搭建吧！</p>
<h3 id="1-搭建流程"><a href="#1-搭建流程" class="headerlink" title="1 搭建流程"></a>1 搭建流程</h3><p>首先看一下我的redis位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;bin# ll</span><br><span class="line">total 40160</span><br><span class="line">drwxr-xr-x 1 root root    4096 Nov 27 00:51 .&#x2F;</span><br><span class="line">drwxr-xr-x 1 root root    4096 Nov 27 11:49 ..&#x2F;</span><br><span class="line">-rw-r--r-- 1 root root     349 Nov 26 23:25 dump.rdb</span><br><span class="line">-rwxr-xr-x 1 root root 4688472 Nov 26 18:37 redis-benchmark*</span><br><span class="line">-rwxr-xr-x 1 root root 8782336 Nov 26 18:37 redis-check-aof*</span><br><span class="line">-rwxr-xr-x 1 root root 8782336 Nov 26 18:37 redis-check-rdb*</span><br><span class="line">-rwxr-xr-x 1 root root 5216680 Nov 26 18:37 redis-cli*</span><br><span class="line">lrwxrwxrwx 1 root root      12 Nov 26 18:37 redis-sentinel -&gt; redis-server*</span><br><span class="line">-rwxr-xr-x 1 root root 8782336 Nov 26 18:37 redis-server*</span><br><span class="line">-rw-r--r-- 1 root root   61796 Nov 26 18:48 redis.conf</span><br></pre></td></tr></table></figure>

<p>1.1 创建Redis节点安装目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local#mkdir redis_cluster</span><br></pre></td></tr></table></figure>

<p>1.2 在redis_cluster目录下，创建7001-7006个文件夹下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;redis_cluster#mkdir 7001 7002 7003 7004 7005 7006</span><br></pre></td></tr></table></figure>

<p>1.3 并将redis.conf分别拷贝到7001-7006文件夹下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;redis_cluster# cp ..&#x2F;bin&#x2F;redis.conf  .&#x2F;7001</span><br><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;redis_cluster# cp ..&#x2F;bin&#x2F;redis.conf  .&#x2F;7002</span><br><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;redis_cluster# cp ..&#x2F;bin&#x2F;redis.conf  .&#x2F;7003</span><br><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;redis_cluster# cp ..&#x2F;bin&#x2F;redis.conf  .&#x2F;7004</span><br><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;redis_cluster# cp ..&#x2F;bin&#x2F;redis.conf  .&#x2F;7005</span><br><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;redis_cluster# cp ..&#x2F;bin&#x2F;redis.conf  .&#x2F;7006</span><br></pre></td></tr></table></figure>

<p>1.4 分别修改配置文件（这里举例7001节点，其他节点类比即可）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">protected-mode no</span><br><span class="line"># bind 127.0.0.1</span><br><span class="line">port 7001</span><br><span class="line">daemonize yes</span><br><span class="line">pidfile &#x2F;var&#x2F;run&#x2F;redis_7001.pid</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file nodes-7001.conf</span><br></pre></td></tr></table></figure>

<p>1.5 复制src到各个节点文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;home&#x2F;michael&#x2F;redis-5.0.7# cp -r src&#x2F; &#x2F;usr&#x2F;local&#x2F;redis_cluster&#x2F;7001</span><br><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;home&#x2F;michael&#x2F;redis-5.0.7# cp -r src&#x2F; &#x2F;usr&#x2F;local&#x2F;redis_cluster&#x2F;7002</span><br><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;home&#x2F;michael&#x2F;redis-5.0.7# cp -r src&#x2F; &#x2F;usr&#x2F;local&#x2F;redis_cluster&#x2F;7003</span><br><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;home&#x2F;michael&#x2F;redis-5.0.7# cp -r src&#x2F; &#x2F;usr&#x2F;local&#x2F;redis_cluster&#x2F;7004</span><br><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;home&#x2F;michael&#x2F;redis-5.0.7# cp -r src&#x2F; &#x2F;usr&#x2F;local&#x2F;redis_cluster&#x2F;7005</span><br><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;home&#x2F;michael&#x2F;redis-5.0.7# cp -r src&#x2F; &#x2F;usr&#x2F;local&#x2F;redis_cluster&#x2F;7006</span><br></pre></td></tr></table></figure>

<p>1.6 启动各个节点（这里只给出7001，其他节点类比即可）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;redis_cluster# .&#x2F;7001&#x2F;src&#x2F;redis-server .&#x2F;7001&#x2F;redis.conf</span><br><span class="line">270:C 27 Nov 2019 12:17:22.135 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span><br><span class="line">270:C 27 Nov 2019 12:17:22.135 # Redis version&#x3D;5.0.7, bits&#x3D;64, commit&#x3D;00000000, modified&#x3D;0, pid&#x3D;270, just started       270:C 27 Nov 2019 12:17:22.135 # Configuration loaded</span><br></pre></td></tr></table></figure>

<p>完成六个节点启动后ps看一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;redis_cluster# ps aux | grep redis</span><br><span class="line">michael    221  0.0  0.0  52352  2236 ?        Ssl  10:26   0:00 .&#x2F;redis-server *:6379</span><br><span class="line">root       271  0.0  0.0  52352  5084 ?        Ssl  12:17   0:00 .&#x2F;7001&#x2F;src&#x2F;redis-server *:7001 [cluster]</span><br><span class="line">root       276  0.0  0.0  52352  5084 ?        Ssl  12:18   0:00 .&#x2F;7002&#x2F;src&#x2F;redis-server *:7002 [cluster]</span><br><span class="line">root       281  0.0  0.0  52352  5092 ?        Ssl  12:18   0:00 .&#x2F;7003&#x2F;src&#x2F;redis-server *:7003 [cluster]</span><br><span class="line">root       293  0.0  0.0  55424  5112 ?        Ssl  12:19   0:00 .&#x2F;7004&#x2F;src&#x2F;redis-server *:7004 [cluster]</span><br><span class="line">root       298  0.0  0.0  52352  5084 ?        Ssl  12:19   0:00 .&#x2F;7005&#x2F;src&#x2F;redis-server *:7005 [cluster]</span><br><span class="line">root       303  0.0  0.0  52352  5088 ?        Ssl  12:19   0:00 .&#x2F;7006&#x2F;src&#x2F;redis-server *:7006 [cluster]</span><br><span class="line">root       315  0.0  0.0  14804  1196 pts&#x2F;0    S    12:20   0:00 grep --color&#x3D;auto redis</span><br></pre></td></tr></table></figure>

<p>1.7 复制redis-trib.rb到/usr/local/bin</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;home&#x2F;michael&#x2F;redis-5.0.7&#x2F;src# cp redis-trib.rb &#x2F;usr&#x2F;local&#x2F;bin&#x2F;</span><br></pre></td></tr></table></figure>

<p>1.8 启动集群</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;bin# redis-trib.rb create --replicas 1 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 127.0.0.1:7006</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;env: ‘ruby’: No such file or directory</span><br></pre></td></tr></table></figure>

<p>报错没有ruby，安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;bin# apt install ruby</span><br></pre></td></tr></table></figure>

<p>1.9 看来我看的教材老了唉</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;bin# redis-trib.rb create --replicas 1 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 127.0.0.1:7006</span><br><span class="line">WARNING: redis-trib.rb is not longer available!</span><br><span class="line">You should use redis-cli instead.</span><br><span class="line"></span><br><span class="line">All commands and features belonging to redis-trib.rb have been moved</span><br><span class="line">to redis-cli.</span><br><span class="line">In order to use them you should call redis-cli with the --cluster</span><br><span class="line">option followed by the subcommand name, arguments and options.</span><br><span class="line"></span><br><span class="line">Use the following syntax:</span><br><span class="line">redis-cli --cluster SUBCOMMAND [ARGUMENTS] [OPTIONS]</span><br><span class="line"></span><br><span class="line">Example:</span><br><span class="line">redis-cli --cluster create 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 127.0.0.1:7006 --cluster-replicas 1</span><br><span class="line"></span><br><span class="line">To get help about all subcommands, type:</span><br><span class="line">redis-cli --cluster help</span><br></pre></td></tr></table></figure>

<p>1.10 按提示来吧</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;bin# redis-cli --cluster create 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 127.0.0.1:7006 --cluster-replicas 1 -a 123456</span><br><span class="line">Warning: Using a password with &#39;-a&#39; or &#39;-u&#39; option on the command line interface may not be safe.</span><br><span class="line">&gt;&gt;&gt; Performing hash slots allocation on 6 nodes...</span><br><span class="line">Master[0] -&gt; Slots 0 - 5460</span><br><span class="line">Master[1] -&gt; Slots 5461 - 10922</span><br><span class="line">Master[2] -&gt; Slots 10923 - 16383</span><br><span class="line">Adding replica 127.0.0.1:7005 to 127.0.0.1:7001</span><br><span class="line">Adding replica 127.0.0.1:7006 to 127.0.0.1:7002</span><br><span class="line">Adding replica 127.0.0.1:7004 to 127.0.0.1:7003</span><br><span class="line">&gt;&gt;&gt; Trying to optimize slaves allocation for anti-affinity</span><br><span class="line">[WARNING] Some slaves are in the same host as their master</span><br><span class="line">M: 081843660c373d95c6c69794da0bca23e3ef7a2a 127.0.0.1:7001</span><br><span class="line">   slots:[0-5460] (5461 slots) master</span><br><span class="line">M: d5d90d62310d8dbfa384e8bea4d0a1b3ae14035b 127.0.0.1:7002</span><br><span class="line">   slots:[5461-10922] (5462 slots) master</span><br><span class="line">M: 42cf5706c29e387d79597ee954bfdf31e43b1bfc 127.0.0.1:7003</span><br><span class="line">   slots:[10923-16383] (5461 slots) master</span><br><span class="line">S: 168711e677c7b6adef17e4779850f3387f86c41c 127.0.0.1:7004</span><br><span class="line">   replicates 42cf5706c29e387d79597ee954bfdf31e43b1bfc</span><br><span class="line">S: d04c5ecc5e79777afd32fe4fb33ddb82c938bc1c 127.0.0.1:7005</span><br><span class="line">   replicates 081843660c373d95c6c69794da0bca23e3ef7a2a</span><br><span class="line">S: bfbc2a40cc4fccf4c9f9727391d574e435c8cc05 127.0.0.1:7006</span><br><span class="line">   replicates d5d90d62310d8dbfa384e8bea4d0a1b3ae14035b</span><br><span class="line">Can I set the above configuration? (type &#39;yes&#39; to accept): yes</span><br><span class="line">&gt;&gt;&gt; Nodes configuration updated</span><br><span class="line">&gt;&gt;&gt; Assign a different config epoch to each node</span><br><span class="line">&gt;&gt;&gt; Sending CLUSTER MEET messages to join the cluster</span><br><span class="line">Waiting for the cluster to join</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt; Performing Cluster Check (using node 127.0.0.1:7001)</span><br><span class="line">M: 081843660c373d95c6c69794da0bca23e3ef7a2a 127.0.0.1:7001</span><br><span class="line">   slots:[0-5460] (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: d5d90d62310d8dbfa384e8bea4d0a1b3ae14035b 127.0.0.1:7002</span><br><span class="line">   slots:[5461-10922] (5462 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: 42cf5706c29e387d79597ee954bfdf31e43b1bfc 127.0.0.1:7003</span><br><span class="line">   slots:[10923-16383] (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: bfbc2a40cc4fccf4c9f9727391d574e435c8cc05 127.0.0.1:7006</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates d5d90d62310d8dbfa384e8bea4d0a1b3ae14035b</span><br><span class="line">S: 168711e677c7b6adef17e4779850f3387f86c41c 127.0.0.1:7004</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 42cf5706c29e387d79597ee954bfdf31e43b1bfc</span><br><span class="line">S: d04c5ecc5e79777afd32fe4fb33ddb82c938bc1c 127.0.0.1:7005</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 081843660c373d95c6c69794da0bca23e3ef7a2a</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line">&gt;&gt;&gt; Check for open slots...</span><br><span class="line">&gt;&gt;&gt; Check slots coverage...</span><br><span class="line">[OK] All 16384 slots covered.</span><br><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;bin#</span><br></pre></td></tr></table></figure>

<p>成了？？？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-JUOEVVQ:&#x2F;usr&#x2F;local&#x2F;redis_cluster# redis-cli -c -h 127.0.0.1 -p 7001 -a 123456</span><br><span class="line">Warning: Using a password with &#39;-a&#39; or &#39;-u&#39; option on the command line interface may not be safe.</span><br><span class="line">127.0.0.1:7001&gt; set foo bar</span><br><span class="line">-&gt; Redirected to slot [12182] located at 127.0.0.1:7003</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:7003&gt; get foo</span><br><span class="line">&quot;bar&quot;</span><br><span class="line">127.0.0.1:7003&gt;</span><br></pre></td></tr></table></figure>

<p>这里要注意一下就是如果节点设置密码的话每个节点的配置文件还要修改一下下面的配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">masterauth 123456</span><br><span class="line">requirepass 123456</span><br></pre></td></tr></table></figure>

<p>这样集群的简单测试就完成了。接下来就是java代码测试一下连接集群</p>
<h3 id="2-Java连接测试"><a href="#2-Java连接测试" class="headerlink" title="2 Java连接测试"></a>2 Java连接测试</h3><p>这里遇到的主要问题就是jedisCluster.auth()用不了了</p>
<p>后来发现在构造里面有带密码的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">JedisCluster</span><span class="params">(Set&lt;HostAndPort&gt; jedisClusterNode, <span class="keyword">int</span> connectionTimeout, <span class="keyword">int</span> soTimeout,</span></span></span><br><span class="line"><span class="function"><span class="params">                      <span class="keyword">int</span> maxAttempts, String password, <span class="keyword">final</span> GenericObjectPoolConfig poolConfig)</span> </span></span><br></pre></td></tr></table></figure>

<p>拿来试试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Jedis Cluster Test Demo</span></span><br><span class="line"><span class="comment">     * Michael Jiang</span></span><br><span class="line"><span class="comment">     * 2019年11月27日 13点24分</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">testJedisCluser</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        Set&lt;HostAndPort&gt; nodes = <span class="keyword">new</span> HashSet&lt;HostAndPort&gt;();</span><br><span class="line">        nodes.add(<span class="keyword">new</span> HostAndPort(<span class="string">&quot;192.168.235.1&quot;</span>,<span class="number">7001</span>));</span><br><span class="line">        nodes.add(<span class="keyword">new</span> HostAndPort(<span class="string">&quot;192.168.235.1&quot;</span>,<span class="number">7002</span>));</span><br><span class="line">        nodes.add(<span class="keyword">new</span> HostAndPort(<span class="string">&quot;192.168.235.1&quot;</span>,<span class="number">7003</span>));</span><br><span class="line">        nodes.add(<span class="keyword">new</span> HostAndPort(<span class="string">&quot;192.168.235.1&quot;</span>,<span class="number">7004</span>));</span><br><span class="line">        nodes.add(<span class="keyword">new</span> HostAndPort(<span class="string">&quot;192.168.235.1&quot;</span>,<span class="number">7005</span>));</span><br><span class="line">        nodes.add(<span class="keyword">new</span> HostAndPort(<span class="string">&quot;192.168.235.1&quot;</span>,<span class="number">7006</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 因为到目前jedis还不兹磁直接设置带密码的集群访问，所以需要使用poolconfig</span></span><br><span class="line">        JedisPoolConfig poolConfig = <span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line"></span><br><span class="line">        JedisCluster jedisCluster = <span class="keyword">new</span> JedisCluster(nodes,<span class="number">1000</span>,<span class="number">1000</span>,<span class="number">100</span>,<span class="string">&quot;123456&quot;</span>,poolConfig);</span><br><span class="line"></span><br><span class="line">        String foo = jedisCluster.get(<span class="string">&quot;foo&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(foo);</span><br><span class="line"></span><br><span class="line">        jedisCluster.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>运行结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bar</span><br></pre></td></tr></table></figure>

<p>吼以了！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/11/27/Redis-Cluster/" data-id="cknhir5d8000a1wtva2ljh5hy" data-title="Redis-Cluster" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/" rel="tag">redis</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-MIME测试" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/11/23/MIME%E6%B5%8B%E8%AF%95/" class="article-date">
  <time class="dt-published" datetime="2019-11-23T13:46:09.000Z" itemprop="datePublished">2019-11-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/11/23/MIME%E6%B5%8B%E8%AF%95/">MIME测试</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p><strong>多用途互联网邮件扩展</strong>（英语：<strong>M</strong>ultipurpose <strong>I</strong>nternet <strong>M</strong>ail <strong>E</strong>xtensions，缩写：<strong>MIME</strong>）是一个<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BA%92%E8%81%94%E7%BD%91%E6%A0%87%E5%87%86">互联网标准</a>，它扩展了<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6">电子邮件</a>标准，使其能够支持：</p>
<ul>
<li>非<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/ASCII">ASCII</a>字符文本；</li>
<li>非文本格式附件（<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BA%8C%E8%BF%9B%E5%88%B6">二进制</a>、声音、图像等）；</li>
<li>由多部分（multiple parts）组成的消息体；</li>
<li>包含非<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/ASCII">ASCII</a>字符的头信息（Header information）。这个标准被定义在 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2045">RFC 2045</a>、<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2046">RFC 2046</a>、<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2047">RFC 2047</a>、<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2048">RFC 2048</a>、<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2049">RFC 2049</a> 等<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/RFC">RFC</a>中。</li>
</ul>
<p>MIME改善了由 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc822">RFC 822</a> 转变而来的 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2822">RFC 2822</a> ，这些旧标准规定<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6">电子邮件</a>标准并不允许在邮件消息中使用7位ASCII字符集以外的字符。正因如此，一些非英语字符消息和二进制文件，图像，声音等非文字消息原本都不能在电子邮件中传输（MIME可以）。MIME规定了用于表示各种各样的数据类型的符号化方法。此外，在<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%B8%87%E7%BB%B4%E7%BD%91">万维网</a>中使用的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE">HTTP协议</a>中也使用了MIME的框架，标准被扩展为<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BA%92%E8%81%94%E7%BD%91%E5%AA%92%E4%BD%93%E7%B1%BB%E5%9E%8B">互联网媒体类型</a>。</p>
</blockquote>
<p>上学期写的senCQ（Java特别版）当时准备使用但由于时间仓促没有仔细研究就无脑切后缀了；现在回过头来研究一下。</p>
<p>发现MIME的Java官方实现也几乎是更具后缀猜嘛？</p>
<p>对于这些你能想到的功能不要一上来就想着自己造轮子（当然如果时间允许，自己造个轮子又何妨？）</p>
<p>首先我们要看一下这个功能官方是否已经实现？比如base64编码，官网已经实现；而我却不知道跑去apache下codec多跑冤枉路！</p>
<p>如果官方已经帮我们办好的话，并且官方的轮子可以在我们的应用场景下转起来；那么就官方即可。</p>
<p>如果官方没有轮子或者官方的轮子不是很好，那么我们就得找第三方的轮子了！</p>
<p>最后！！！很不幸，没有找到第三方轮子，亦或是第三方的轮子根本转不了，这时候你可以尝试修复一下别人的轮子（上次闲着写了个senMusic）找了个网上找了个lrc-parser的轮子，结果转的不是很顺溜，简单修复一下就OK了；如果没有别人的轮子，那就自己动手，丰衣足食！</p>
<p>说了这么多，直接进入正题吧！直接看代码，一目了然！</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Path;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">	<span class="comment">// write your code here</span></span><br><span class="line">        Path path = Paths.get(<span class="string">&quot;D:/未命名.html&quot;</span>);</span><br><span class="line">        System.out.println(Files.probeContentType(path));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">text/html</span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>结果如上！！！</p>
<p>但是当我把文件后缀名改为exe结果又如下所示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">application&#x2F;x-msdownload</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>

<p>所以说嘛，只是简单的后缀判断，猜测而已不然为啥叫**<code>probeContentType</code>**</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/11/23/MIME%E6%B5%8B%E8%AF%95/" data-id="cknhir5d500051wtv9vlq7uvv" data-title="MIME测试" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Win7-企业版密钥和kms激活" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/11/15/Win7-%E4%BC%81%E4%B8%9A%E7%89%88%E5%AF%86%E9%92%A5%E5%92%8Ckms%E6%BF%80%E6%B4%BB/" class="article-date">
  <time class="dt-published" datetime="2019-11-15T13:53:48.000Z" itemprop="datePublished">2019-11-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/11/15/Win7-%E4%BC%81%E4%B8%9A%E7%89%88%E5%AF%86%E9%92%A5%E5%92%8Ckms%E6%BF%80%E6%B4%BB/">Win7 企业版密钥和kms激活</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="0、win7企业版激活密钥永久激活"><a href="#0、win7企业版激活密钥永久激活" class="headerlink" title="0、win7企业版激活密钥永久激活"></a>0、win7企业版激活密钥永久激活</h2><p>Windows 7 All Volume Editions Volume:MAK</p>
<p>Enterprise;EnterpriseN;EnterpriseE;Professional;ProfessionalN;ProfessionalE</p>
<p>[Key]：2KBDJ-V84CF-YWTPX-W726F-6CPJV</p>
<p>[Key]：34BCY-QMR8R-T779J-KFF4R-C28YF</p>
<p>[Key]：36MDV-B48XY-7F2VX-KH9FC-YDKDW</p>
<p>[Key]：38977-FFR38-X9FMX-WHXMQ-JF8WF</p>
<p>[Key]：3W6GX-GGYCQ-GQ3FC-PH92W-D8G3J</p>
<p>[Key]：3W6VK-BB6P4-GCV98-GQM6X-RD8MG</p>
<h2 id="1、windows7企业版产品密钥kms安装密钥"><a href="#1、windows7企业版产品密钥kms安装密钥" class="headerlink" title="1、windows7企业版产品密钥kms安装密钥"></a>1、windows7企业版产品密钥kms安装密钥</h2><p>Windows 7 Enterprise Volume:GVLK</p>
<p>Windows 7 企业版：33PXH-7Y6KF-2VJC9-XBBR8-HVTHH</p>
<p>Windows 7 企业版 N：YDRBP-3D83W-TY26F-D46B2-XCKRJ</p>
<p>Windows 7 企业版 E：C29WB-22CC8-VJ326-GHFJW-H9DH4</p>
<p>注：win7 N版本和E版本是针对欧洲定制的，因为欧盟反垄断法的关系，欧洲版系统不包含Internet Explorer和Windows  Media Player，除此之外基本一样。其中N版不包含Windows Media Player，E版不包含Internet  Explorer。</p>
<p>2、打开命令提示符，依次执行下面的代码，分别表示：安装win7企业版密钥，设置kms服务器，激活win7企业版，查询激活期限，kms一般是180天，到期后再次激活。<a target="_blank" rel="noopener" href="http://www.xitongcheng.com/jiaocheng/dnrj_article_44606.html">可用的</a><a target="_blank" rel="noopener" href="http://www.xitongcheng.com/jiaocheng/dnrj_article_44606.html">kms</a><a target="_blank" rel="noopener" href="http://www.xitongcheng.com/jiaocheng/dnrj_article_44606.html">激活服务器有哪些</a>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">slmgr &#x2F;ipk 33PXH-7Y6KF-2VJC9-XBBR8-HVTHH</span><br><span class="line"></span><br><span class="line">slmgr &#x2F;skms zh.us.to</span><br><span class="line"></span><br><span class="line">slmgr &#x2F;ato</span><br><span class="line"></span><br><span class="line">slmgr &#x2F;xpr</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/11/15/Win7-%E4%BC%81%E4%B8%9A%E7%89%88%E5%AF%86%E9%92%A5%E5%92%8Ckms%E6%BF%80%E6%B4%BB/" data-id="cknhir5da000c1wtv9fqt4pyk" data-title="Win7 企业版密钥和kms激活" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Linux网络编程之信号的处理-Win10-Linux子系统" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/10/31/Linux%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E4%B9%8B%E4%BF%A1%E5%8F%B7%E7%9A%84%E5%A4%84%E7%90%86-Win10-Linux%E5%AD%90%E7%B3%BB%E7%BB%9F/" class="article-date">
  <time class="dt-published" datetime="2019-10-31T14:01:53.000Z" itemprop="datePublished">2019-10-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/10/31/Linux%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E4%B9%8B%E4%BF%A1%E5%8F%B7%E7%9A%84%E5%A4%84%E7%90%86-Win10-Linux%E5%AD%90%E7%B3%BB%E7%BB%9F/">Linux网络编程之信号的处理 &amp;&amp; Win10 Linux子系统</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="0、Linux子系统安装和配置"><a href="#0、Linux子系统安装和配置" class="headerlink" title="0、Linux子系统安装和配置"></a>0、Linux子系统安装和配置</h2><p>要想体验Win10 的linux子系统</p>
<ul>
<li>首先需要去Window功能里面勾选<strong>适用于Linux的Windows子系统</strong></li>
</ul>
<p><img src="/images/20191030231211.png" alt="img">、</p>
<ul>
<li>去微软商店下载一个子系统即可</li>
</ul>
<p><img src="/images/20191030231530.png" alt="img"></p>
<p>这里我下载的是Ubuntu 18.04 LTS 哈哈</p>
<p><img src="/images/20191030231720.png" alt="img"></p>
<p>就像安装软件一样，啥时Linux也搞一个windows子系统呢？</p>
<p>这时就会有一个小问题，这个linux的用户目录是否可以在windows文件管理器上找到？答案是肯定的！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Michael Jiang\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu18.04onWindows_79rhkp1fndgsc\LocalState\rootfs\home\michael</span><br></pre></td></tr></table></figure>

<p>如上所示，就是我的用户目录所在位置。</p>
<p>当然最好不要把写的代码放在这里面，容易丢失（如果你像我一样被重置电脑就能感受的这个痛点）</p>
<p>对于使用linux进行linux网络编程，其实你可以这样：</p>
<p>1.使用Windows文件管理器切换到代码所在目录</p>
<p>2.然后按住Shift同时点击鼠标右键可以看到</p>
<p><img src="/images/2019-10-30232633.png" alt="img"></p>
<p>这样就可以进行编译，测试了，美滋滋！</p>
<h2 id="1、Linux网络编程之信号量的处理"><a href="#1、Linux网络编程之信号量的处理" class="headerlink" title="1、Linux网络编程之信号量的处理"></a>1、Linux网络编程之信号量的处理</h2><p>几乎所有的信号都将终止接收到该信号的进程。对于一些简单的程序，这完全能满足要求。用户按了中断或者退出键，就可以停止一个有问题的程序的运行。但是在大型的程序中，一些意料之外的信号会导致大问题。例如，正当在对一个重要的数据库进行修改期间，由于不小心碰到了中断键，而使程序被意外的终止，从而产生严重的后果。UNIX  的系统调用signal()用于接收一个指定类型的信号，并可以指定相应的方法。这就是说，signal()能够将指定的处理函数与信号向关联。它在Linux 系统库signal.h 中的函<br> 数声明如下：<br> int signal (int sig, __sighandler_t handler);<br> Signal()有两个参数：<br> 第一个参数sig 指明了所要处理的信号类型，它可以取除了SIGKILL 和SIGSTOP 外的任何一种信号。</p>
<p>第二个参数handler 描述了与信号关联的动作，它可以取以下三种值：</p>
<p><strong>1. 一个返回值为整数的函数地址。</strong><br> 此函数必须在signal()被调用前声明，handler 中为这个函数的名字。当接收到一个类型为sig 的信号时，就执行handler 所指定的函数。这个函数应有如下形式的定义：<br> int func(int sig);<br> sig 是传递给它的唯一参数。执行了signal()调用后，进程只要接收到类型为sig 的信号，<br> 不管其正在执行程序的哪一部分，就立即执行func()函数。当func()函数执行结束后，控制<br> 权返回进程被中断的那一点继续执行。</p>
<p><strong>2.SIG_IGN</strong><br> 这个符号表示忽略信号。执行了相应的signal()调用好，进程会忽略类型为sig 的信号。</p>
<p><strong>3.SIG_DFL</strong><br> 这个符号表示恢复系统对信号的默认处理。<br> 函数如果执行成功，就返回信号在此次signal()调用之前的关联。<br> 如果函数执行失败，就返回SIG_ERR。通常这种情况只有当sig 参数不是有效的信号<br> 时才会发生。函数不对handler 的有效性进行检查。</p>
<p>在Linux 程序中常常利用SIG_IGN 和SIG_DFL 屏蔽SIGINT 和SIGQUIT 来保证执行重要任务的程序不会被意外的中止。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 信号的处理</span></span><br><span class="line"><span class="comment"> * Michael Jiang</span></span><br><span class="line"><span class="comment"> * Wed Oct 30 23:31:39 CST 2019</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;signal.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    signal(SIGINT,SIG_IGN); <span class="comment">//告诉进程将SIGINT信号忽略</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;aaaaaaaaaa\n&quot;</span>);</span><br><span class="line">    sleep(<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;bbbbbbbbbb\n&quot;</span>);</span><br><span class="line">    signal(SIGINT,SIG_DFL); <span class="comment">//恢复对SIGINT信号的处理</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ gcc signal_test.c &amp;&amp; .&#x2F;a.out</span><br><span class="line">aaaaaaaaaa</span><br><span class="line">^C</span><br><span class="line">^C</span><br><span class="line">^C</span><br><span class="line">^C</span><br><span class="line">^C</span><br><span class="line">^C</span><br><span class="line">^C</span><br><span class="line">^C</span><br><span class="line">bbbbbbbbbb</span><br></pre></td></tr></table></figure>

<p>可以看出在程序打印完aaaaaaaaaa后我使用CTRL+C进行终止结果进程均未响应我的终止信号。</p>
<p>再看信号复位问题：</p>
<p>在Linux 中，当一个信号的信号处理函数执行时，如果进程又接收到了该信号，该信号会自动被储存而不会中断信号处理函数的执行，直到信号处理函数执行完毕再重新调用相应的处理函数。下面的程序演示了这一点：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 信号的处理之捕获中捕获</span></span><br><span class="line"><span class="comment"> * Michael Jiang</span></span><br><span class="line"><span class="comment"> * Thu Oct 31 09:29:01 CST 2019</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;signal.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> sig)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    signal(SIGINT,func); <span class="comment">//告诉进程将SIGINT信号交给func函数处理</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;aaaaaaaaaa\n&quot;</span>);</span><br><span class="line">    sleep(<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;bbbbbbbbbb\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> sig)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;开始逮！sig=%d\n&quot;</span>,sig);</span><br><span class="line">    sleep(<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;逮到了！sig=%d\n&quot;</span>,sig);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ .&#x2F;a.out</span><br><span class="line">aaaaaaaaaa</span><br><span class="line">^C开始逮！sig&#x3D;2</span><br><span class="line">^C</span><br><span class="line">^C</span><br><span class="line">^C</span><br><span class="line">逮到了！sig&#x3D;2</span><br><span class="line">开始逮！sig&#x3D;2</span><br><span class="line">逮到了！sig&#x3D;2</span><br><span class="line">bbbbbbbbbb</span><br></pre></td></tr></table></figure>

<p>分析：程序开始执行当按下第一个^C时进入处理信号函数，接着又连续按了多个^C等第一个^C的处理执行完成后程序返回执行第二个^C的处理函数然后程序就结束了？？？</p>
<p>对于第三个和第四个^C均未处理，可以得到在处理过程中只能接受一个排队信号！！！</p>
<p>最后介绍一下alarm()</p>
<p>1．系统调用alarm()<br> alarm()是一个简单而有用的系统调用，它可以建立一个进程的报警时钟，在时钟定时器到时的时候，用信号向程序报告。alarm()系统调用在Linux 系统函数库unistd.h 中的函数<br> 声明如下：</p>
<p>unsigned int alarm(unsigned int seconds);<br> 函数唯一的参数是seconds，其以秒为单位给出了定时器的时间。当时间到达的时候，<br> 就向系统发送一个SIGARLM 信号。例如：<br> alarm(60);<br> 这一调用实现在60 秒后发一个SIGALRM 信号。alarm 不会象sleep  那样暂停调用进程的执行，它能立即返回，并使进程继续执行，直至指定的延迟时间到达发出SIGALRM信号。事实上，一个由alarm()调用设置好的报警时钟，在通过exec()调用后，仍将继续有效。但是，它在fork()调用后中，在子进程中失效。如果要使设置的报警时钟失效，只需要调用参数为零的alarm()：<br> alarm(0)</p>
<p>alarm()调用也不能积累。如果调用alarm 两次，则第二次调用就取代第一次调用。但是，alarm 的返回值柜橱了前一次设定的报警时钟的剩余时间。<br> 当需要对某项工作设置时间限制时，可以使用alarm()调用来实现。其基本方法为：先调用alarm()按时间限制值设置报警时钟，然后进程作某一工作。如果进程在规定时间以内完成这一工作，就再调用alarm(0)使报警时钟失效。如果在规定时间内未能完成这一工作，进程就会被报警时钟的SIGALRM 信号中断，然后对它进行校正。</p>
<p>下面通过一个简单的限时答题程序来演示一下alarm的使用。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 限时答题程序</span></span><br><span class="line"><span class="comment"> * Michael Jiang</span></span><br><span class="line"><span class="comment"> * Thu Oct 31 10:04:21 CST 2019</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BELL <span class="meta-string">&#x27;\007&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TIMEOUT 5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> score = <span class="number">0</span>;  <span class="comment">//得分</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// alarm信号处理函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">catch</span><span class="params">(<span class="keyword">int</span> sig)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">putchar</span>(BELL);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n你答题超时了！\n得分:%d\n&quot;</span>,score);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;紧张刺激的限时答题程序\n你将回答五道加法题，每道题限时五秒！\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 先绑定一下信号处理方法</span></span><br><span class="line">    signal(SIGALRM,<span class="keyword">catch</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">int</span> lop,rop;</span><br><span class="line">    <span class="keyword">while</span> (cnt--)</span><br><span class="line">    &#123;</span><br><span class="line">        srand((<span class="keyword">int</span>)time(<span class="literal">NULL</span>)); </span><br><span class="line">        lop = rand() % <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">        rop = rand() % <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d+%d=&quot;</span>,lop,rop);</span><br><span class="line">        alarm(TIMEOUT);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;ans);</span><br><span class="line">        <span class="keyword">if</span>(ans == lop + rop)&#123;</span><br><span class="line">            score++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;恭喜完成所有题目,最终得分:%d\n&quot;</span>,score);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当我们每道题都在5s内给出答案就不会触发alarm信号</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ .&#x2F;a.out</span><br><span class="line">紧张刺激的限时答题程序</span><br><span class="line">你将回答五道加法题，每道题限时五秒！</span><br><span class="line">2+6&#x3D;8</span><br><span class="line">0+2&#x3D;2</span><br><span class="line">4+9&#x3D;13</span><br><span class="line">5+3&#x3D;8</span><br><span class="line">2+8&#x3D;10</span><br><span class="line">恭喜完成所有题目,最终得分:5</span><br></pre></td></tr></table></figure>

<p>但是如果某道题超时的话就会直接结束游戏</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ .&#x2F;a.out</span><br><span class="line">紧张刺激的限时答题程序</span><br><span class="line">你将回答五道加法题，每道题限时五秒！</span><br><span class="line">2+3&#x3D;</span><br><span class="line">你答题超时了！</span><br><span class="line">得分:0</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/10/31/Linux%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E4%B9%8B%E4%BF%A1%E5%8F%B7%E7%9A%84%E5%A4%84%E7%90%86-Win10-Linux%E5%AD%90%E7%B3%BB%E7%BB%9F/" data-id="cknhj0du8000018tvbw41aw8y" data-title="Linux网络编程之信号的处理 &amp;&amp; Win10 Linux子系统" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Error-could-not-open-xxx-jre-lib-amd64-jvm-cfg" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/10/30/Error-could-not-open-xxx-jre-lib-amd64-jvm-cfg/" class="article-date">
  <time class="dt-published" datetime="2019-10-30T14:11:27.000Z" itemprop="datePublished">2019-10-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/10/30/Error-could-not-open-xxx-jre-lib-amd64-jvm-cfg/">Error: could not open xxx\jre\lib\amd64\jvm.cfg</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="0、问题再现"><a href="#0、问题再现" class="headerlink" title="0、问题再现"></a>0、问题再现</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Michael Jiang&gt;java -version</span><br><span class="line">Error: could not open &#96;D:\DevSoftware\jre\lib\amd64\jvm.cfg&#39;</span><br></pre></td></tr></table></figure>

<p>当我在cmd输入java -version 想查看一下Java版本的时候突然出现如上的奇怪报错。</p>
<p>几天前先是体验Docker把Hyper-v打开了，然后听说腾讯QQ更新了linuxqq又想开虚拟机体验一把，于是将Hyper-v关闭，结果就出事了。。。</p>
<p>无法正常启动，windows提示我重置电脑，我想重置就重置吧？</p>
<p>结果给我C盘自己装的软件全部删了，还给我一个<strong>已删除的应用.html</strong> 是怕重装时想不起我都装了什么软件吧！</p>
<p>于是我决定对于一些开发软件不再安装至C盘了，你在上面的报错信息中或许可以看出我把这些软件都安装在D盘了<code>D:\DevSoftware</code></p>
<h3 id="1、深入探究"><a href="#1、深入探究" class="headerlink" title="1、深入探究"></a>1、深入探究</h3><p>的确，根据报错上提供的地址是找不到<strong>jvm.cfg</strong> 因为我在安装jre的时候就给它安装在<code>D:\DevSoftware\jre</code>，根据这个路径也配置了环境变量；后来又觉得文件夹名字不带版本有点难受，所以给它重命名过从jre改成了jre1.8.0_231，结果今天想看一下java版本就报错了。</p>
<h3 id="2、解决方法"><a href="#2、解决方法" class="headerlink" title="2、解决方法"></a>2、解决方法</h3><p>通过询问度娘，得知需要修改注册表里面记录的安装目录值即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">计算机\HKEY_LOCAL_MACHINE\SOFTWARE\JavaSoft\Java Runtime Environment\1.8.0_231\MSI</span><br></pre></td></tr></table></figure>

<p><img src="/images/20191030175936.png" alt="img"></p>
<p>OK，问题解决！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/10/30/Error-could-not-open-xxx-jre-lib-amd64-jvm-cfg/" data-id="cknhjaafd0000k0tv0upmbv02" data-title="Error: could not open xxx\jre\lib\amd64\jvm.cfg" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/error/" rel="tag">error</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Assembly-包含多个段的程序-DEBUG使用指南" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/10/26/Assembly-%E5%8C%85%E5%90%AB%E5%A4%9A%E4%B8%AA%E6%AE%B5%E7%9A%84%E7%A8%8B%E5%BA%8F-DEBUG%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" class="article-date">
  <time class="dt-published" datetime="2019-10-26T14:23:39.000Z" itemprop="datePublished">2019-10-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/10/26/Assembly-%E5%8C%85%E5%90%AB%E5%A4%9A%E4%B8%AA%E6%AE%B5%E7%9A%84%E7%A8%8B%E5%BA%8F-DEBUG%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/">Assembly-包含多个段的程序 &amp; DEBUG使用指南</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>时隔近一年，再次拾起Asm，这次因该可以一下学到底？</p>
<p>我使用的工具是DOSBox-&gt;<a target="_blank" rel="noopener" href="http://sencom.top/?p=392">使用 DOSBox 学习 Assembly</a></p>
<p>今天就拿书上的程序6.4例子看一看吧！顺便提一下我用的是王爽的《汇编语言（第3版）》很棒的汇编入门教材。</p>
<p>直接看程序：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code,ds:data,ss:stack</span><br><span class="line"></span><br><span class="line">data segment</span><br><span class="line">    dw 0123h, 0456h, 0789h, 0abch, 0defh, 0fedh, 0cbah, 0987h</span><br><span class="line">data ends</span><br><span class="line"></span><br><span class="line">stack segment</span><br><span class="line">    dw 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0</span><br><span class="line">stack ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line"></span><br><span class="line">start:  mov ax,stack</span><br><span class="line">        mov ss,ax</span><br><span class="line">        mov sp,20h ;设置栈顶ss:sp指向stack:20</span><br><span class="line"></span><br><span class="line">        mov ax,data</span><br><span class="line">        mov ds,ax   ;ds:bx指向data段中的第一个单元</span><br><span class="line"></span><br><span class="line">        mov bx,0</span><br><span class="line">        mov cx,8</span><br><span class="line">    s:  push [bx]</span><br><span class="line">        add bx,2</span><br><span class="line">        loop s  ;此循环是将data段中的0~15单元中的8个字型数据依次入栈</span><br><span class="line"></span><br><span class="line">        mov bx,0</span><br><span class="line">    s0: pop [bx]</span><br><span class="line">        add bx,2</span><br><span class="line">        loop s0 ;此循环是将出栈8个字型数据到data段的0~15单元中</span><br><span class="line"></span><br><span class="line">        mov ax,4c00h</span><br><span class="line">        int 21h</span><br><span class="line">code ends</span><br><span class="line"></span><br><span class="line">end start</span><br></pre></td></tr></table></figure>

<p>这个程序将数据，代码，栈放到了不同的段中，这样可以使得代码显得结构清晰。</p>
<p>功能分析：使用栈将数据段中的8个字型的数据进行反转。</p>
<p>下面通过DEBUG来运行</p>
<p><img src="/images/20191026203839.png" alt="img"></p>
<p>使用t命令进行单步运行（后面会总结常用的DEBUG命令）</p>
<p>通过第一个红框可以发现DS段地址为076A，此时我们使用-d命令查看076a:0开始向后128个单元的内存内容可以发现我们在数据段中定义的8个字型数据（存放为高字节在前，底字节在后）</p>
<p>继续使用-t命令执行</p>
<p><img src="/images/20191026204924.png" alt="img"></p>
<p>执行完后再次使用-d命令查看内存 发现076a:0—-076a:9这段内存中的数据的确反转了。</p>
<p>下面是DEBUG工具常用命令：</p>
<p>DEBUG下最常用的调试指令为六个</p>
<p>一、常用DEBUG命令</p>
<p>（1）R ：查看更改cpu寄存器内容</p>
<p>（2）D：查看内存中内容</p>
<p>（3）E：改写内存中内容</p>
<p>（4）U：将内存中机器指令翻译成汇编指令</p>
<p>（5）T：执行一条机器指令</p>
<p>（6）A：以汇编格式在内存中写入一条指令</p>
<p>二、常用命令的使用</p>
<p>1.R命令：查看 更改CPU寄存器内容</p>
<p>输入r后回车，会显示所有寄存器的数值</p>
<p>如果修改寄存器数据 如ax寄存器数值 则输入“r ax”后回车，在“：”后输入新数据，回车则修改完成。</p>
<p><img src="/images/20191026210124.png" alt="img"></p>
<p>2.命令d: 查看内存数据</p>
<p>D命令显示数据个数如下所示，内存地址格式为【段地址：偏移地址】，段地址和偏移地址共同组成内存地址，实际内存地址=段地址+偏移地址</p>
<p>直接输入d 显示的内存区域地址为上次查看位置后内存数据</p>
<p>输入命令时，可以直接输入内存地址，查看制定地址的内存数据。如D【1000:0000】 直接显示命令 段地址为1000，偏移地址为0 的内存数据。</p>
<p>采用“d 段地址：起始偏移地址 结尾偏移地址 ”可以查看起始地址到结尾地址范围内的数据 。如“d 073f:0 9” 查看数据范围为“073f:0 ~ 073f:9”</p>
<p><img src="/images/20191026210300.png" alt="img"></p>
<p>3.E命令改写内存中的数据</p>
<p>（1）“e 段地址：偏移地址 数据1 数据2 … 数据n”方式，一次性修改指定地址的n个数据</p>
<p>（2）.”e 段地址：偏移地址” 按照提示 单个输入</p>
<p>输入命令后，光标停在“.”后，“.”前为改地址原始数据，在“.”后输入新数据 ，按空格 修改下一个地址数据。输入完成，直接按回车</p>
<p>（3）“e 段地址：偏移地址 ‘字符1’ ‘字符2’ …‘字符n’ ”在指定地址输入n个字符</p>
<p><img src="/images/20191026210851.png" alt="img"></p>
<p>\4. 命令 U 将指定地址的机器码翻译为汇编指令，并显示出来</p>
<p>格式：“U 段地址：偏移地址”</p>
<p><img src="/images/20191026211011.png" alt="img"></p>
<p>5.T指令 执行一条或者多条指令</p>
<p>使用T 指令 执行内存地址为【CS寄存器数值：IP寄存器数据】位置的指令</p>
<p>（1）ax寄存器原始数据为0000，修改cs:ip = 1000:100后，在cs:ip 写入 “MOV AX , 1”的机器码，使用t命令执行后，ax寄存器数据被修改为0001</p>
<p>6.A命令，以汇编形式在内存中输入机器指令</p>
<p><img src="/images/20191026211313.png" alt="img"></p>
<p>Happy Coding!!!</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/10/26/Assembly-%E5%8C%85%E5%90%AB%E5%A4%9A%E4%B8%AA%E6%AE%B5%E7%9A%84%E7%A8%8B%E5%BA%8F-DEBUG%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" data-id="cknhjrh8r00006ktv8szcc44l" data-title="Assembly-包含多个段的程序 &amp; DEBUG使用指南" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/assembly/" rel="tag">assembly</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-操作系统之进程调度算法-FCFS，RR，SJF" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/10/26/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95-FCFS%EF%BC%8CRR%EF%BC%8CSJF/" class="article-date">
  <time class="dt-published" datetime="2019-10-26T14:16:33.000Z" itemprop="datePublished">2019-10-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/10/26/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95-FCFS%EF%BC%8CRR%EF%BC%8CSJF/">操作系统之进程调度算法-FCFS，RR，SJF</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>本次重要模拟三种进程调度算法即</p>
<ul>
<li>先来先服务（FCFS）</li>
<li>时间片轮转（RR）</li>
<li>短进程优先（SJF）</li>
</ul>
<p>并分别计算他们的作业周转时间和带权周转时间以及平均作业周转时间和平均带权周转时间。</p>
<p>首先定义 进程控制块(PCB)结构体</p>
<p>mypcb.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _MY_PCB_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _MY_PCB_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stddef.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PROCESS_RUNNING  1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PROCESS_READY    2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PROCESS_CREATE	 3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PROCESS_BLOCKING 4</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PROCESS_DEAD     5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">PCB</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> pid;    <span class="comment">// 进程号</span></span><br><span class="line">    <span class="keyword">int</span> status; <span class="comment">// 进程状态</span></span><br><span class="line">    <span class="keyword">int</span> jid;     <span class="comment">// 作业号</span></span><br><span class="line"></span><br><span class="line">&#125;PCB;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 进程初始化</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pcb_init</span><span class="params">(PCB *pcb, <span class="keyword">int</span> pid, <span class="keyword">int</span> status, <span class="keyword">int</span> jid)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断进程是否全部死亡</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">is_all_dead</span><span class="params">(PCB *pcb)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>mypcb.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;mypcb.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pcb_init</span><span class="params">(PCB *pcb, <span class="keyword">int</span> pid, <span class="keyword">int</span> status, <span class="keyword">int</span> jid)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    pcb[pid].pid = pid;</span><br><span class="line">    pcb[pid].status = status;</span><br><span class="line">    pcb[pid].jid = jid;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">is_all_dead</span><span class="params">(PCB *pcb)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(pcb[i].status != PROCESS_DEAD)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来是FCFS</p>
<p>FCFS.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _FCFS_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _FCFS_H</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;mypcb.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FCFS</span><span class="params">(PCB *pcb, <span class="keyword">int</span> *job)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>FCFS.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 进程调度之先来先服务算法</span></span><br><span class="line"><span class="comment"> * M.J</span></span><br><span class="line"><span class="comment"> * Fri Oct 18 21:56:21 DST 2019</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;FCFS.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fcfs_clock = <span class="number">0</span>; <span class="comment">//时钟</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> fcfs_r_turn_time_total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">double</span> fcfs_turn_time_total = <span class="number">0</span>;</span><br><span class="line"><span class="comment">// CPU执行</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fcfs_call_cpu</span><span class="params">(PCB *pcb, <span class="keyword">int</span> *job)</span></span>&#123;</span><br><span class="line">    pcb-&gt;status = PROCESS_RUNNING;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> each_time = job[pcb-&gt;jid];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;pid =%d jid=%d call_cpu[%d-&quot;</span>,pcb-&gt;pid,pcb-&gt;jid,fcfs_clock);</span><br><span class="line">    fcfs_clock += job[pcb-&gt;jid];</span><br><span class="line">    job[pcb-&gt;jid] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d]\n&quot;</span>,fcfs_clock);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;pid=%d jid=%d finshed turn_time=%d r_turn_time=%lf\n&quot;</span>,\</span><br><span class="line">            pcb-&gt;pid,pcb-&gt;jid,fcfs_clock,fcfs_clock/(each_time * <span class="number">1.0</span>));</span><br><span class="line">    fcfs_r_turn_time_total += fcfs_clock/(each_time * <span class="number">1.0</span>);</span><br><span class="line">    fcfs_turn_time_total += fcfs_clock;</span><br><span class="line">    pcb-&gt;status = PROCESS_DEAD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FCFS</span><span class="params">(PCB *pcb, <span class="keyword">int</span> *job)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 假设作业进入顺序为job[0]~job[9]</span></span><br><span class="line">    <span class="comment">//执行</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(pcb[i].status == PROCESS_READY)&#123;</span><br><span class="line">                fcfs_call_cpu(&amp;pcb[i],job);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(is_all_dead(pcb))&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;ave_turn_time=%lf ave_r_turn_time=%lf\n&quot;</span>,fcfs_turn_time_total / <span class="number">10.0</span> ,fcfs_r_turn_time_total / <span class="number">10</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对于短进程优先算法我们还需要一个排序算法将作业排序</p>
<p>quicksort.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _QUICK_SORT_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>	_QUICK_SORT_H</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">quick_sort</span><span class="params">(<span class="keyword">int</span> a[], <span class="keyword">int</span> size,<span class="keyword">int</span> *work_order)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">array_copy</span><span class="params">(<span class="keyword">int</span> *src,<span class="keyword">int</span> src_size, <span class="keyword">int</span> *dst, <span class="keyword">int</span> dst_size)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>quicksort.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *快速排序</span></span><br><span class="line"><span class="comment"> *M.J</span></span><br><span class="line"><span class="comment"> *Sat Oct 19 08:35:25 UTC 2019</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">      </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span>     </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;quicksort.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置排序规则</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">compare</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> * a, <span class="keyword">const</span> <span class="keyword">void</span> * b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ( *(<span class="keyword">int</span>*)a - *(<span class="keyword">int</span>*)b );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">quick_sort</span><span class="params">(<span class="keyword">int</span> a[], <span class="keyword">int</span> size,<span class="keyword">int</span> *work_order)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> b[size];</span><br><span class="line">	array_copy(a,<span class="number">10</span>,b,<span class="number">10</span>);</span><br><span class="line">	qsort(b, size, <span class="keyword">sizeof</span>(<span class="keyword">int</span>), compare);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; size; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">size_t</span> j = <span class="number">0</span>; j &lt; size; j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[j] == b[i])&#123;</span><br><span class="line">				work_order[i] = j;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">array_copy</span><span class="params">(<span class="keyword">int</span> *src,<span class="keyword">int</span> src_size, <span class="keyword">int</span> *dst, <span class="keyword">int</span> dst_size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (dst_size &lt; src_size)&#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; src_size; i++)&#123;</span><br><span class="line">		dst[i] = src[i];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SJF.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _SJF_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _SJF_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;mypcb.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SJF</span><span class="params">(PCB *pcb, <span class="keyword">int</span> *job)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>SJF.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *进程调度之短作业优先算法</span></span><br><span class="line"><span class="comment"> *M.J</span></span><br><span class="line"><span class="comment"> *Sat Oct 19 08:31:25 UTC 2019</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;mypcb.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;quicksort.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;SJF.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> sjf_clock = <span class="number">0</span>; <span class="comment">//时钟</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> sjf_r_turn_time_total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">double</span> sjf_turn_time_total = <span class="number">0</span>;</span><br><span class="line"><span class="comment">// CPU执行</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sjf_call_cpu</span><span class="params">(PCB *pcb, <span class="keyword">int</span> *job)</span></span>&#123;</span><br><span class="line">    pcb-&gt;status = PROCESS_RUNNING;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> each_time = job[pcb-&gt;jid];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;pid =%d jid=%d call_cpu[%d-&quot;</span>,pcb-&gt;pid,pcb-&gt;jid,sjf_clock);</span><br><span class="line">    sjf_clock += job[pcb-&gt;jid];</span><br><span class="line">    job[pcb-&gt;jid] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d]\n&quot;</span>,sjf_clock);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;pid=%d jid=%d finshed turn_time=%d r_turn_time=%lf\n&quot;</span>,\</span><br><span class="line">            pcb-&gt;pid,pcb-&gt;jid,sjf_clock,sjf_clock/(each_time * <span class="number">1.0</span>));</span><br><span class="line">    sjf_r_turn_time_total += sjf_clock/(each_time * <span class="number">1.0</span>);</span><br><span class="line">    sjf_turn_time_total += sjf_clock;</span><br><span class="line">    pcb-&gt;status = PROCESS_DEAD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SJF</span><span class="params">(PCB *pcb, <span class="keyword">int</span> *job)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 作业序列</span></span><br><span class="line">	<span class="keyword">int</span> work_order[<span class="number">10</span>];</span><br><span class="line">	</span><br><span class="line">	quick_sort(job,<span class="number">10</span>,work_order);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//执行</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(pcb[work_order[i]].status == PROCESS_READY)&#123;</span><br><span class="line">                sjf_call_cpu(&amp;pcb[work_order[i]],job);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(is_all_dead(pcb))&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;ave_turn_time=%lf ave_r_turn_time=%lf\n&quot;</span>,sjf_turn_time_total / <span class="number">10.0</span> ,sjf_r_turn_time_total / <span class="number">10</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>RR.h</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _RR_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _RR_H</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;mypcb.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RR</span><span class="params">(PCB *pcb, <span class="keyword">int</span> *job)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>RR.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 进程调度之时间片轮转法</span></span><br><span class="line"><span class="comment"> * M.J</span></span><br><span class="line"><span class="comment"> * Fri Oct 18 22:16:11 DST 2019</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RR_TIME_SLICE 5 <span class="comment">// 时间片大小</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;RR.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> rr_clock = <span class="number">0</span>; <span class="comment">//时钟</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> rr_r_turn_time_total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">double</span> rr_turn_time_total = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> rr_each_time[<span class="number">10</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="comment">// CPU执行</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rr_call_cpu</span><span class="params">(PCB *pcb, <span class="keyword">int</span> *job)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> each_time = <span class="number">0</span>;</span><br><span class="line">    rr_each_time[pcb-&gt;jid] = job[pcb-&gt;jid];</span><br><span class="line">    pcb-&gt;status = PROCESS_RUNNING;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;pid =%d jid=%d call_cpu[%d-&quot;</span>,pcb-&gt;pid,pcb-&gt;jid,rr_clock);</span><br><span class="line">    <span class="keyword">if</span>(job[pcb-&gt;jid] &gt; RR_TIME_SLICE)&#123;</span><br><span class="line">        job[pcb-&gt;jid] -= RR_TIME_SLICE;</span><br><span class="line">        rr_clock += <span class="number">5</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d]\n&quot;</span>,rr_clock);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        each_time = rr_clock;</span><br><span class="line">        rr_clock += job[pcb-&gt;jid];</span><br><span class="line">        job[pcb-&gt;jid] = <span class="number">0</span>;</span><br><span class="line">        pcb-&gt;status = PROCESS_DEAD;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d]\n&quot;</span>,rr_clock);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;pid=%d jid=%d finshed turn_time=%d r_turn_time=%lf\n&quot;</span>,\</span><br><span class="line">            pcb-&gt;pid,pcb-&gt;jid,rr_clock,rr_clock/(rr_each_time[pcb-&gt;jid] * <span class="number">1.0</span>));</span><br><span class="line">        rr_r_turn_time_total += rr_clock/(rr_each_time[pcb-&gt;jid] * <span class="number">1.0</span>);</span><br><span class="line">        rr_turn_time_total += rr_clock;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    pcb-&gt;status = PROCESS_READY;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RR</span><span class="params">(PCB *pcb, <span class="keyword">int</span> *job)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//执行</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(pcb[i].status == PROCESS_READY)&#123;</span><br><span class="line">                rr_call_cpu(&amp;pcb[i],job);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(is_all_dead(pcb))&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;ave_turn_time=%lf ave_r_turn_time=%lf\n&quot;</span>,rr_turn_time_total / <span class="number">10.0</span> ,rr_r_turn_time_total / <span class="number">10.0</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后就是我们的main函数了哈哈！</p>
<p>main.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;mypcb.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;RR.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;FCFS.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;SJF.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_JOB_SIZE 10 <span class="comment">// 最大作业数</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//每个作业的周转时间</span></span><br><span class="line"><span class="comment">//平均周转时间</span></span><br><span class="line"><span class="comment">//带权周转时间</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 定义JOB数组 存放时长</span></span><br><span class="line">    <span class="keyword">int</span> job[MAX_JOB_SIZE] = &#123;</span><br><span class="line">        <span class="number">10</span>, <span class="number">12</span>, <span class="number">24</span>,  <span class="number">5</span>, <span class="number">19</span>,</span><br><span class="line">        <span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>, <span class="number">44</span>, <span class="number">55</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义PCB块</span></span><br><span class="line">    PCB pcb[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化进程并分配作业</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">        pcb_init(pcb,i,PROCESS_READY,i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;+---[Process Schedule Demo]--+\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;|1.FCFS                      |\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;|2.RR                        |\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;|3.SJF                       |\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;|4.Exit                      |\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;+----------------------------+\n&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> op = <span class="number">3</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;op);</span><br><span class="line">    <span class="keyword">switch</span> (op)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        FCFS(pcb,job);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        RR(pcb,job);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">		SJF(pcb,job);</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编译和运行：</p>
<p><img src="/images/20191026212840.png" alt="img"></p>
<p>这里我为什么要放一张图片？</p>
<p>当然是展示一下我的Desktop PC终于升级到win10 1903了！（虽然丢失了很多东西）</p>
<p>选1执行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&gt;1</span><br><span class="line">pid &#x3D;0 jid&#x3D;0 call_cpu[0-10]</span><br><span class="line">pid&#x3D;0 jid&#x3D;0 finshed turn_time&#x3D;10 r_turn_time&#x3D;1.000000</span><br><span class="line">pid &#x3D;1 jid&#x3D;1 call_cpu[10-22]</span><br><span class="line">pid&#x3D;1 jid&#x3D;1 finshed turn_time&#x3D;22 r_turn_time&#x3D;1.833333</span><br><span class="line">pid &#x3D;2 jid&#x3D;2 call_cpu[22-46]</span><br><span class="line">pid&#x3D;2 jid&#x3D;2 finshed turn_time&#x3D;46 r_turn_time&#x3D;1.916667</span><br><span class="line">pid &#x3D;3 jid&#x3D;3 call_cpu[46-51]</span><br><span class="line">pid&#x3D;3 jid&#x3D;3 finshed turn_time&#x3D;51 r_turn_time&#x3D;10.200000</span><br><span class="line">pid &#x3D;4 jid&#x3D;4 call_cpu[51-70]</span><br><span class="line">pid&#x3D;4 jid&#x3D;4 finshed turn_time&#x3D;70 r_turn_time&#x3D;3.684211</span><br><span class="line">pid &#x3D;5 jid&#x3D;5 call_cpu[70-81]</span><br><span class="line">pid&#x3D;5 jid&#x3D;5 finshed turn_time&#x3D;81 r_turn_time&#x3D;7.363636</span><br><span class="line">pid &#x3D;6 jid&#x3D;6 call_cpu[81-103]</span><br><span class="line">pid&#x3D;6 jid&#x3D;6 finshed turn_time&#x3D;103 r_turn_time&#x3D;4.681818</span><br><span class="line">pid &#x3D;7 jid&#x3D;7 call_cpu[103-136]</span><br><span class="line">pid&#x3D;7 jid&#x3D;7 finshed turn_time&#x3D;136 r_turn_time&#x3D;4.121212</span><br><span class="line">pid &#x3D;8 jid&#x3D;8 call_cpu[136-180]</span><br><span class="line">pid&#x3D;8 jid&#x3D;8 finshed turn_time&#x3D;180 r_turn_time&#x3D;4.090909</span><br><span class="line">pid &#x3D;9 jid&#x3D;9 call_cpu[180-235]</span><br><span class="line">pid&#x3D;9 jid&#x3D;9 finshed turn_time&#x3D;235 r_turn_time&#x3D;4.272727</span><br><span class="line">ave_turn_time&#x3D;93.400000 ave_r_turn_time&#x3D;4.316451</span><br><span class="line"></span><br><span class="line">C:\Users\Michael Jiang\Desktop\OS\Process_Schedule_Algorithms&gt;</span><br></pre></td></tr></table></figure>

<p>选2执行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&gt;2</span><br><span class="line">pid &#x3D;0 jid&#x3D;0 call_cpu[0-5]</span><br><span class="line">pid &#x3D;1 jid&#x3D;1 call_cpu[5-10]</span><br><span class="line">pid &#x3D;2 jid&#x3D;2 call_cpu[10-15]</span><br><span class="line">pid &#x3D;3 jid&#x3D;3 call_cpu[15-20]</span><br><span class="line">pid&#x3D;3 jid&#x3D;3 finshed turn_time&#x3D;20 r_turn_time&#x3D;4.000000</span><br><span class="line">pid &#x3D;4 jid&#x3D;4 call_cpu[20-25]</span><br><span class="line">pid &#x3D;5 jid&#x3D;5 call_cpu[25-30]</span><br><span class="line">pid &#x3D;6 jid&#x3D;6 call_cpu[30-35]</span><br><span class="line">pid &#x3D;7 jid&#x3D;7 call_cpu[35-40]</span><br><span class="line">pid &#x3D;8 jid&#x3D;8 call_cpu[40-45]</span><br><span class="line">pid &#x3D;9 jid&#x3D;9 call_cpu[45-50]</span><br><span class="line">pid &#x3D;0 jid&#x3D;0 call_cpu[50-55]</span><br><span class="line">pid&#x3D;0 jid&#x3D;0 finshed turn_time&#x3D;55 r_turn_time&#x3D;11.000000</span><br><span class="line">pid &#x3D;1 jid&#x3D;1 call_cpu[55-60]</span><br><span class="line">pid &#x3D;2 jid&#x3D;2 call_cpu[60-65]</span><br><span class="line">pid &#x3D;4 jid&#x3D;4 call_cpu[65-70]</span><br><span class="line">pid &#x3D;5 jid&#x3D;5 call_cpu[70-75]</span><br><span class="line">pid &#x3D;6 jid&#x3D;6 call_cpu[75-80]</span><br><span class="line">pid &#x3D;7 jid&#x3D;7 call_cpu[80-85]</span><br><span class="line">pid &#x3D;8 jid&#x3D;8 call_cpu[85-90]</span><br><span class="line">pid &#x3D;9 jid&#x3D;9 call_cpu[90-95]</span><br><span class="line">pid &#x3D;1 jid&#x3D;1 call_cpu[95-97]</span><br><span class="line">pid&#x3D;1 jid&#x3D;1 finshed turn_time&#x3D;97 r_turn_time&#x3D;48.500000</span><br><span class="line">pid &#x3D;2 jid&#x3D;2 call_cpu[97-102]</span><br><span class="line">pid &#x3D;4 jid&#x3D;4 call_cpu[102-107]</span><br><span class="line">pid &#x3D;5 jid&#x3D;5 call_cpu[107-108]</span><br><span class="line">pid&#x3D;5 jid&#x3D;5 finshed turn_time&#x3D;108 r_turn_time&#x3D;108.000000</span><br><span class="line">pid &#x3D;6 jid&#x3D;6 call_cpu[108-113]</span><br><span class="line">pid &#x3D;7 jid&#x3D;7 call_cpu[113-118]</span><br><span class="line">pid &#x3D;8 jid&#x3D;8 call_cpu[118-123]</span><br><span class="line">pid &#x3D;9 jid&#x3D;9 call_cpu[123-128]</span><br><span class="line">pid &#x3D;2 jid&#x3D;2 call_cpu[128-133]</span><br><span class="line">pid &#x3D;4 jid&#x3D;4 call_cpu[133-137]</span><br><span class="line">pid&#x3D;4 jid&#x3D;4 finshed turn_time&#x3D;137 r_turn_time&#x3D;34.250000</span><br><span class="line">pid &#x3D;6 jid&#x3D;6 call_cpu[137-142]</span><br><span class="line">pid &#x3D;7 jid&#x3D;7 call_cpu[142-147]</span><br><span class="line">pid &#x3D;8 jid&#x3D;8 call_cpu[147-152]</span><br><span class="line">pid &#x3D;9 jid&#x3D;9 call_cpu[152-157]</span><br><span class="line">pid &#x3D;2 jid&#x3D;2 call_cpu[157-161]</span><br><span class="line">pid&#x3D;2 jid&#x3D;2 finshed turn_time&#x3D;161 r_turn_time&#x3D;40.250000</span><br><span class="line">pid &#x3D;6 jid&#x3D;6 call_cpu[161-163]</span><br><span class="line">pid&#x3D;6 jid&#x3D;6 finshed turn_time&#x3D;163 r_turn_time&#x3D;81.500000</span><br><span class="line">pid &#x3D;7 jid&#x3D;7 call_cpu[163-168]</span><br><span class="line">pid &#x3D;8 jid&#x3D;8 call_cpu[168-173]</span><br><span class="line">pid &#x3D;9 jid&#x3D;9 call_cpu[173-178]</span><br><span class="line">pid &#x3D;7 jid&#x3D;7 call_cpu[178-183]</span><br><span class="line">pid &#x3D;8 jid&#x3D;8 call_cpu[183-188]</span><br><span class="line">pid &#x3D;9 jid&#x3D;9 call_cpu[188-193]</span><br><span class="line">pid &#x3D;7 jid&#x3D;7 call_cpu[193-196]</span><br><span class="line">pid&#x3D;7 jid&#x3D;7 finshed turn_time&#x3D;196 r_turn_time&#x3D;65.333333</span><br><span class="line">pid &#x3D;8 jid&#x3D;8 call_cpu[196-201]</span><br><span class="line">pid &#x3D;9 jid&#x3D;9 call_cpu[201-206]</span><br><span class="line">pid &#x3D;8 jid&#x3D;8 call_cpu[206-211]</span><br><span class="line">pid &#x3D;9 jid&#x3D;9 call_cpu[211-216]</span><br><span class="line">pid &#x3D;8 jid&#x3D;8 call_cpu[216-220]</span><br><span class="line">pid&#x3D;8 jid&#x3D;8 finshed turn_time&#x3D;220 r_turn_time&#x3D;55.000000</span><br><span class="line">pid &#x3D;9 jid&#x3D;9 call_cpu[220-225]</span><br><span class="line">pid &#x3D;9 jid&#x3D;9 call_cpu[225-230]</span><br><span class="line">pid &#x3D;9 jid&#x3D;9 call_cpu[230-235]</span><br><span class="line">pid&#x3D;9 jid&#x3D;9 finshed turn_time&#x3D;235 r_turn_time&#x3D;47.000000</span><br><span class="line">ave_turn_time&#x3D;139.200000 ave_r_turn_time&#x3D;49.483333</span><br><span class="line"></span><br><span class="line">C:\Users\Michael Jiang\Desktop\OS\Process_Schedule_Algorithms&gt;</span><br></pre></td></tr></table></figure>

<p>选3执行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt;3</span><br><span class="line">pid &#x3D;3 jid&#x3D;3 call_cpu[0-5]</span><br><span class="line">pid&#x3D;3 jid&#x3D;3 finshed turn_time&#x3D;5 r_turn_time&#x3D;1.000000</span><br><span class="line">pid &#x3D;0 jid&#x3D;0 call_cpu[5-15]</span><br><span class="line">pid&#x3D;0 jid&#x3D;0 finshed turn_time&#x3D;15 r_turn_time&#x3D;1.500000</span><br><span class="line">pid &#x3D;5 jid&#x3D;5 call_cpu[15-26]</span><br><span class="line">pid&#x3D;5 jid&#x3D;5 finshed turn_time&#x3D;26 r_turn_time&#x3D;2.363636</span><br><span class="line">pid &#x3D;1 jid&#x3D;1 call_cpu[26-38]</span><br><span class="line">pid&#x3D;1 jid&#x3D;1 finshed turn_time&#x3D;38 r_turn_time&#x3D;3.166667</span><br><span class="line">pid &#x3D;4 jid&#x3D;4 call_cpu[38-57]</span><br><span class="line">pid&#x3D;4 jid&#x3D;4 finshed turn_time&#x3D;57 r_turn_time&#x3D;3.000000</span><br><span class="line">pid &#x3D;6 jid&#x3D;6 call_cpu[57-79]</span><br><span class="line">pid&#x3D;6 jid&#x3D;6 finshed turn_time&#x3D;79 r_turn_time&#x3D;3.590909</span><br><span class="line">pid &#x3D;2 jid&#x3D;2 call_cpu[79-103]</span><br><span class="line">pid&#x3D;2 jid&#x3D;2 finshed turn_time&#x3D;103 r_turn_time&#x3D;4.291667</span><br><span class="line">pid &#x3D;7 jid&#x3D;7 call_cpu[103-136]</span><br><span class="line">pid&#x3D;7 jid&#x3D;7 finshed turn_time&#x3D;136 r_turn_time&#x3D;4.121212</span><br><span class="line">pid &#x3D;8 jid&#x3D;8 call_cpu[136-180]</span><br><span class="line">pid&#x3D;8 jid&#x3D;8 finshed turn_time&#x3D;180 r_turn_time&#x3D;4.090909</span><br><span class="line">pid &#x3D;9 jid&#x3D;9 call_cpu[180-235]</span><br><span class="line">pid&#x3D;9 jid&#x3D;9 finshed turn_time&#x3D;235 r_turn_time&#x3D;4.272727</span><br><span class="line">ave_turn_time&#x3D;87.400000 ave_r_turn_time&#x3D;3.139773</span><br></pre></td></tr></table></figure>

<p>选4是退出。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://bh6aol.top/2019/10/26/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B9%8B%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95-FCFS%EF%BC%8CRR%EF%BC%8CSJF/" data-id="cknhjhl390000rgtvc57x2kt1" data-title="操作系统之进程调度算法-FCFS，RR，SJF" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algo/" rel="tag">algo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/" rel="tag">c</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; zurück</a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/adb/" rel="tag">adb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algo/" rel="tag">algo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/assembly/" rel="tag">assembly</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/" rel="tag">c</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/error/" rel="tag">error</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/golang/" rel="tag">golang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/junit/" rel="tag">junit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mybatis/" rel="tag">mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/project/" rel="tag">project</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/raspberrypi/" rel="tag">raspberrypi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/" rel="tag">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rsa/" rel="tag">rsa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/" rel="tag">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/adb/" style="font-size: 10px;">adb</a> <a href="/tags/algo/" style="font-size: 10px;">algo</a> <a href="/tags/android/" style="font-size: 17.5px;">android</a> <a href="/tags/assembly/" style="font-size: 10px;">assembly</a> <a href="/tags/c/" style="font-size: 15px;">c</a> <a href="/tags/error/" style="font-size: 15px;">error</a> <a href="/tags/golang/" style="font-size: 10px;">golang</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/junit/" style="font-size: 10px;">junit</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/mybatis/" style="font-size: 12.5px;">mybatis</a> <a href="/tags/project/" style="font-size: 10px;">project</a> <a href="/tags/raspberrypi/" style="font-size: 10px;">raspberrypi</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/rsa/" style="font-size: 10px;">rsa</a> <a href="/tags/spring/" style="font-size: 10px;">spring</a> <a href="/tags/windows/" style="font-size: 12.5px;">windows</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/04/14/yum-update-%E6%8A%A5%E9%94%99/">yum update 报错</a>
          </li>
        
          <li>
            <a href="/2021/02/08/JUNIT-CLASS-NOT-FOUND-MYTEST/">JUNIT : CLASS NOT FOUND: &#39;MYTEST&#39;</a>
          </li>
        
          <li>
            <a href="/2021/02/05/MYBATIS-2-%E6%95%B4%E5%90%88SPRING5/">MYBATIS-2-整合SPRING5</a>
          </li>
        
          <li>
            <a href="/2021/02/01/MYBATIS-1-%E7%AC%AC%E4%B8%80%E4%B8%AA%E4%BE%8B%E5%AD%90/">MYBATIS-1-第一个例子</a>
          </li>
        
          <li>
            <a href="/2021/01/20/%E8%A1%A8%E5%8D%95%E5%85%B3%E9%94%AE%E4%BF%A1%E6%81%AF%E7%9A%84%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E4%BC%A0%E8%BE%93/">表单关键信息的非对称加密传输</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 BH6AOL<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>